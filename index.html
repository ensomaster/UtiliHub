<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>UtiliHub - Your All-in-One Utility Tools Hub</title>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/jspdf/2.5.1/jspdf.umd.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/pdf.js/3.11.174/pdf.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/mammoth/1.4.2/mammoth.browser.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/jszip/3.10.1/jszip.min.js"></script>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: 'Inter', -apple-system, BlinkMacSystemFont, sans-serif;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            min-height: 100vh;
            color: #333;
            line-height: 1.6;
        }

        .container {
            max-width: 1200px;
            margin: 0 auto;
            padding: 20px;
        }

        .header {
            text-align: center;
            margin-bottom: 40px;
            color: white;
        }

        .header h1 {
            font-size: 3rem;
            font-weight: 700;
            margin-bottom: 10px;
            text-shadow: 0 2px 4px rgba(0,0,0,0.3);
        }

        .header p {
            font-size: 1.2rem;
            opacity: 0.9;
        }

        .search-container {
            margin-bottom: 30px;
            position: relative;
        }

        .search-input {
            width: 100%;
            padding: 15px 50px 15px 20px;
            border: none;
            border-radius: 15px;
            background: rgba(255, 255, 255, 0.1);
            backdrop-filter: blur(10px);
            border: 1px solid rgba(255, 255, 255, 0.2);
            color: white;
            font-size: 1rem;
            placeholder-color: rgba(255, 255, 255, 0.7);
        }

        .search-input::placeholder {
            color: rgba(255, 255, 255, 0.7);
        }

        .tools-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(300px, 1fr));
            gap: 20px;
            margin-bottom: 40px;
        }

        .tool-card {
            background: rgba(255, 255, 255, 0.1);
            backdrop-filter: blur(10px);
            border: 1px solid rgba(255, 255, 255, 0.2);
            border-radius: 20px;
            padding: 25px;
            text-align: center;
            cursor: pointer;
            transition: all 0.3s ease;
            color: white;
        }

        .tool-card:hover {
            transform: translateY(-5px);
            background: rgba(255, 255, 255, 0.15);
            border-color: rgba(255, 255, 255, 0.3);
        }

        .tool-icon {
            font-size: 3rem;
            margin-bottom: 15px;
            display: block;
        }

        .tool-title {
            font-size: 1.3rem;
            font-weight: 600;
            margin-bottom: 10px;
        }

        .tool-status {
            font-size: 0.8rem;
            margin-top: 10px;
            padding: 5px 12px;
            border-radius: 15px;
            font-weight: 600;
        }

        .tool-status.working {
            background: rgba(39, 174, 96, 0.2);
            color: #27ae60;
            border: 1px solid rgba(39, 174, 96, 0.3);
        }

        .tool-status.coming-soon {
            background: rgba(243, 156, 18, 0.2);
            color: #f39c12;
            border: 1px solid rgba(243, 156, 18, 0.3);
        }

        .tool-card.coming-soon {
            opacity: 0.8;
        }

        .tool-card.coming-soon:hover {
            transform: translateY(-2px);
            opacity: 1;
        }

        .modal {
            display: none;
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: rgba(0, 0, 0, 0.8);
            z-index: 1000;
            backdrop-filter: blur(5px);
        }

        .modal-content {
            position: absolute;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%);
            background: rgba(255, 255, 255, 0.95);
            backdrop-filter: blur(20px);
            border-radius: 20px;
            padding: 30px;
            max-width: 90vw;
            max-height: 90vh;
            overflow-y: auto;
            border: 1px solid rgba(255, 255, 255, 0.3);
        }

        .modal-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 20px;
            padding-bottom: 15px;
            border-bottom: 2px solid rgba(0, 0, 0, 0.1);
        }

        .modal-title {
            font-size: 1.5rem;
            font-weight: 600;
            color: #333;
        }

        .close-btn {
            background: none;
            border: none;
            font-size: 1.5rem;
            cursor: pointer;
            padding: 5px;
            border-radius: 50%;
            transition: background 0.3s ease;
        }

        .close-btn:hover {
            background: rgba(0, 0, 0, 0.1);
        }

        .file-drop-zone {
            border: 2px dashed #667eea;
            border-radius: 15px;
            padding: 40px 20px;
            text-align: center;
            margin: 20px 0;
            transition: all 0.3s ease;
            cursor: pointer;
        }

        .file-drop-zone:hover,
        .file-drop-zone.dragover {
            border-color: #764ba2;
            background: rgba(102, 126, 234, 0.05);
        }

        .file-input {
            display: none;
        }

        .btn {
            background: linear-gradient(135deg, #667eea, #764ba2);
            color: white;
            border: none;
            padding: 12px 25px;
            border-radius: 10px;
            cursor: pointer;
            font-size: 1rem;
            transition: all 0.3s ease;
            margin: 5px;
        }

        .btn:hover {
            transform: translateY(-2px);
            box-shadow: 0 5px 15px rgba(0, 0, 0, 0.2);
        }

        .btn:disabled {
            opacity: 0.6;
            cursor: not-allowed;
            transform: none;
        }

        .btn.secondary {
            background: white;
            color: #667eea;
            border: 2px solid #667eea;
        }

        .btn.secondary:hover {
            background: #667eea;
            color: white;
        }

        .progress-bar {
            width: 100%;
            height: 8px;
            background: #e0e0e0;
            border-radius: 4px;
            overflow: hidden;
            margin: 10px 0;
            display: none;
        }

        .progress-fill {
            height: 100%;
            background: linear-gradient(90deg, #667eea, #764ba2);
            transition: width 0.3s ease;
            width: 0%;
        }

        .result-area {
            margin-top: 20px;
            padding: 20px;
            background: #f8f9fa;
            border-radius: 10px;
            display: none;
        }

        .format-buttons {
            display: flex;
            flex-wrap: wrap;
            gap: 10px;
            margin: 20px 0;
        }

        .format-btn {
            padding: 8px 16px;
            border: 2px solid #667eea;
            background: white;
            color: #667eea;
            border-radius: 8px;
            cursor: pointer;
            transition: all 0.3s ease;
        }

        .format-btn:hover,
        .format-btn.active {
            background: #667eea;
            color: white;
        }

        .image-preview {
            max-width: 300px;
            max-height: 300px;
            border-radius: 10px;
            margin: 10px 0;
        }

        .file-info {
            background: #e3f2fd;
            padding: 15px;
            border-radius: 10px;
            margin: 10px 0;
        }

        .coming-soon-content {
            text-align: center;
            padding: 40px 20px;
        }

        .coming-soon-icon {
            font-size: 4rem;
            margin-bottom: 20px;
        }

        .coming-soon-content h3 {
            color: #f39c12;
            margin-bottom: 20px;
            font-size: 1.8rem;
        }

        .coming-soon-content p {
            margin-bottom: 20px;
            color: #666;
            line-height: 1.6;
        }

        .coming-soon-content ul {
            text-align: left;
            max-width: 400px;
            margin: 20px auto;
            padding: 0;
        }

        .coming-soon-content li {
            margin-bottom: 10px;
            color: #555;
            list-style: none;
            padding-left: 0;
        }

        /* Enhanced PDF Converter Styles */
        .usage-tracker {
            background: linear-gradient(135deg, #667eea, #764ba2);
            color: white;
            padding: 20px;
            border-radius: 15px;
            margin-bottom: 20px;
            text-align: center;
        }

        .usage-bar {
            background: rgba(255, 255, 255, 0.2);
            height: 8px;
            border-radius: 4px;
            margin: 10px 0;
            overflow: hidden;
        }

        .usage-fill {
            background: white;
            height: 100%;
            transition: width 0.3s ease;
            border-radius: 4px;
        }

        .processing-modes {
            display: flex;
            gap: 20px;
            margin-bottom: 20px;
        }

        .mode-card {
            flex: 1;
            background: #f8f9fa;
            border: 2px solid #e9ecef;
            border-radius: 15px;
            padding: 20px;
            cursor: pointer;
            transition: all 0.3s ease;
            text-align: center;
        }

        .mode-card.active {
            border-color: #667eea;
            background: rgba(102, 126, 234, 0.1);
        }

        .mode-card:hover {
            transform: translateY(-2px);
            box-shadow: 0 5px 15px rgba(0, 0, 0, 0.1);
        }

        .mode-icon {
            font-size: 2rem;
            margin-bottom: 10px;
        }

        .batch-drop-zone {
            border: 3px dashed #667eea;
            border-radius: 20px;
            padding: 40px 20px;
            text-align: center;
            margin: 20px 0;
            transition: all 0.3s ease;
            cursor: pointer;
        }

        .batch-drop-zone:hover,
        .batch-drop-zone.dragover {
            border-color: #764ba2;
            background: rgba(102, 126, 234, 0.05);
            transform: scale(1.02);
        }

        .file-queue {
            max-height: 400px;
            overflow-y: auto;
            margin: 20px 0;
        }

        .file-item {
            background: white;
            border: 1px solid #e9ecef;
            border-radius: 10px;
            padding: 15px;
            margin-bottom: 10px;
            display: flex;
            align-items: center;
            gap: 15px;
        }

        .file-details {
            flex: 1;
        }

        .file-name {
            font-weight: 600;
            margin-bottom: 5px;
        }

        .file-meta {
            font-size: 0.9rem;
            color: #666;
        }

        .file-progress {
            width: 150px;
            height: 6px;
            background: #e9ecef;
            border-radius: 3px;
            overflow: hidden;
        }

        .file-progress-bar {
            height: 100%;
            background: linear-gradient(90deg, #667eea, #764ba2);
            transition: width 0.3s ease;
        }

        .file-status {
            width: 80px;
            text-align: center;
            font-size: 0.9rem;
            font-weight: 500;
        }

        .status-pending { color: #6c757d; }
        .status-processing { color: #007bff; }
        .status-completed { color: #28a745; }
        .status-error { color: #dc3545; }

        .file-actions {
            display: flex;
            gap: 5px;
        }

        .action-btn {
            background: none;
            border: none;
            padding: 8px;
            border-radius: 6px;
            cursor: pointer;
            transition: background 0.3s ease;
            font-size: 1rem;
        }

        .action-btn:hover {
            background: rgba(0, 0, 0, 0.1);
        }

        .batch-controls {
            display: flex;
            gap: 15px;
            justify-content: center;
            margin: 20px 0;
            flex-wrap: wrap;
        }

        .batch-summary {
            background: #f8f9fa;
            border-radius: 15px;
            padding: 25px;
            margin: 20px 0;
            text-align: center;
        }

        .summary-stats {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(120px, 1fr));
            gap: 20px;
            margin: 20px 0;
        }

        .stat-item {
            background: white;
            padding: 15px;
            border-radius: 10px;
            border: 1px solid #e9ecef;
        }

        .stat-number {
            font-size: 1.8rem;
            font-weight: 700;
            color: #667eea;
        }

        .stat-label {
            font-size: 0.9rem;
            color: #666;
            margin-top: 5px;
        }

        .processing-overlay {
            position: fixed;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background: rgba(0, 0, 0, 0.8);
            backdrop-filter: blur(5px);
            display: none;
            align-items: center;
            justify-content: center;
            z-index: 2000;
        }

        .processing-card {
            background: white;
            border-radius: 20px;
            padding: 40px;
            text-align: center;
            max-width: 500px;
            margin: 20px;
        }

        .spinner {
            width: 60px;
            height: 60px;
            border: 4px solid #f3f3f3;
            border-top: 4px solid #667eea;
            border-radius: 50%;
            animation: spin 1s linear infinite;
            margin: 20px auto;
        }

        @keyframes spin {
            0% { transform: rotate(0deg); }
            100% { transform: rotate(360deg); }
        }

        .toast {
            position: fixed;
            top: 20px;
            right: 20px;
            padding: 15px 25px;
            border-radius: 10px;
            color: white;
            font-weight: 500;
            z-index: 10000;
            transform: translateX(400px);
            transition: transform 0.3s ease;
        }

        .toast.show {
            transform: translateX(0);
        }

        .toast.success {
            background: #28a745;
        }

        .toast.error {
            background: #dc3545;
        }

        .toast.warning {
            background: #ffc107;
            color: #333;
        }

        @media (max-width: 768px) {
            .header h1 {
                font-size: 2rem;
            }
            
            .modal-content {
                margin: 10px;
                width: calc(100% - 20px);
                max-width: none;
            }
            
            .tools-grid {
                grid-template-columns: 1fr;
            }

            .processing-modes {
                flex-direction: column;
            }
            
            .batch-controls {
                flex-direction: column;
            }
            
            .summary-stats {
                grid-template-columns: repeat(2, 1fr);
            }
        }
    </style>
</head>
<body>
    <div class="container">
        <div class="header">
            <h1>🚀 UtiliHub</h1>
            <p>Your All-in-One Utility Tools Hub</p>
            <p>No downloads, no signups - just instant results</p>
        </div>

        <div class="search-container">
            <input type="text" class="search-input" id="searchTools" placeholder="Search tools...">
        </div>

        <div class="tools-grid">
            <!-- Working Tools -->
            <div class="tool-card" data-tool="pdf-converter">
                <span class="tool-icon">📄</span>
                <div class="tool-title">PDF Converter</div>
                <div class="tool-description">Enhanced with batch processing and usage tracking</div>
                <div class="tool-status working">✅ Enhanced</div>
            </div>

            <div class="tool-card" data-tool="pdf-to-text">
                <span class="tool-icon">📄→📝</span>
                <div class="tool-title">PDF to Text/Word</div>
                <div class="tool-description">Extract and format text from PDFs, save as Word</div>
                <div class="tool-status working">✅ Working</div>
            </div>

            <div class="tool-card" data-tool="image-converter">
                <span class="tool-icon">🖼️</span>
                <div class="tool-title">Image Converter</div>
                <div class="tool-description">Convert between PNG, JPEG, WebP, BMP, GIF, TIFF formats</div>
                <div class="tool-status working">✅ Working</div>
            </div>

            <div class="tool-card" data-tool="calculator">
                <span class="tool-icon">🧮</span>
                <div class="tool-title">Scientific Calculator</div>
                <div class="tool-description">Advanced calculations with history</div>
                <div class="tool-status working">✅ Working</div>
            </div>

            <div class="tool-card" data-tool="text-tools">
                <span class="tool-icon">📝</span>
                <div class="tool-title">Text Tools</div>
                <div class="tool-description">Word counter, case converter, Lorem generator</div>
                <div class="tool-status working">✅ Working</div>
            </div>

            <!-- Coming Soon Tools -->
            <div class="tool-card coming-soon" data-tool="url-shortener">
                <span class="tool-icon">🔗</span>
                <div class="tool-title">URL Shortener</div>
                <div class="tool-description">Create short links for long URLs</div>
                <div class="tool-status coming-soon">🚧 Coming Soon</div>
            </div>

            <div class="tool-card coming-soon" data-tool="qr-generator">
                <span class="tool-icon">📱</span>
                <div class="tool-title">QR Code Generator</div>
                <div class="tool-description">Generate QR codes for text, URLs, and more</div>
                <div class="tool-status coming-soon">🚧 Coming Soon</div>
            </div>

            <div class="tool-card coming-soon" data-tool="color-tools">
                <span class="tool-icon">🎨</span>
                <div class="tool-title">Color Tools</div>
                <div class="tool-description">Color picker, palette generator, converter</div>
                <div class="tool-status coming-soon">🚧 Coming Soon</div>
            </div>

            <div class="tool-card coming-soon" data-tool="password-generator">
                <span class="tool-icon">🔒</span>
                <div class="tool-title">Password Generator</div>
                <div class="tool-description">Generate secure passwords with custom options</div>
                <div class="tool-status coming-soon">🚧 Coming Soon</div>
            </div>

            <div class="tool-card coming-soon" data-tool="base64-converter">
                <span class="tool-icon">🔤</span>
                <div class="tool-title">Base64 Encoder/Decoder</div>
                <div class="tool-description">Encode and decode Base64 strings</div>
                <div class="tool-status coming-soon">🚧 Coming Soon</div>
            </div>

            <div class="tool-card coming-soon" data-tool="hash-generator">
                <span class="tool-icon">🔐</span>
                <div class="tool-title">Hash Generator</div>
                <div class="tool-description">Generate MD5, SHA1, SHA256 hashes</div>
                <div class="tool-status coming-soon">🚧 Coming Soon</div>
            </div>

            <div class="tool-card coming-soon" data-tool="json-formatter">
                <span class="tool-icon">📋</span>
                <div class="tool-title">JSON Formatter</div>
                <div class="tool-description">Format, validate, and minify JSON data</div>
                <div class="tool-status coming-soon">🚧 Coming Soon</div>
            </div>
        </div>
    </div>

    <!-- Coming Soon Tools Modals -->
    <div id="url-shortener-modal" class="modal">
        <div class="modal-content">
            <div class="modal-header">
                <h3 class="modal-title">🔗 URL Shortener</h3>
                <button class="close-btn">&times;</button>
            </div>
            <div class="coming-soon-content">
                <div class="coming-soon-icon">🚧</div>
                <h3>Coming Soon!</h3>
                <p>This powerful URL shortening tool is currently under development. Soon you'll be able to:</p>
                <ul>
                    <li>✨ Create short, memorable links</li>
                    <li>📊 Track click analytics</li>
                    <li>🎯 Custom alias support</li>
                    <li>⏰ Expiration date settings</li>
                    <li>🔐 Password protection</li>
                </ul>
                <p><strong>Expected Release:</strong> Coming in Phase 2</p>
            </div>
        </div>
    </div>

    <div id="qr-generator-modal" class="modal">
        <div class="modal-content">
            <div class="modal-header">
                <h3 class="modal-title">📱 QR Code Generator</h3>
                <button class="close-btn">&times;</button>
            </div>
            <div class="coming-soon-content">
                <div class="coming-soon-icon">🚧</div>
                <h3>Coming Soon!</h3>
                <p>Advanced QR code generation is in development. Features will include:</p>
                <ul>
                    <li>🔗 URLs, text, and contact info</li>
                    <li>🎨 Customizable colors and styles</li>
                    <li>📏 Multiple size options</li>
                    <li>💾 PNG, SVG, and PDF export</li>
                    <li>🔍 Error correction levels</li>
                </ul>
                <p><strong>Expected Release:</strong> Next 2 weeks</p>
            </div>
        </div>
    </div>

    <div id="color-tools-modal" class="modal">
        <div class="modal-content">
            <div class="modal-header">
                <h3 class="modal-title">🎨 Color Tools</h3>
                <button class="close-btn">&times;</button>
            </div>
            <div class="coming-soon-content">
                <div class="coming-soon-icon">🚧</div>
                <h3>Coming Soon!</h3>
                <p>Comprehensive color tools suite in development:</p>
                <ul>
                    <li>🎯 Color picker and wheel</li>
                    <li>🔄 HEX, RGB, HSL converter</li>
                    <li>🎨 Palette generator</li>
                    <li>♿ Accessibility checker</li>
                    <li>🌈 Gradient generator</li>
                </ul>
                <p><strong>Expected Release:</strong> Coming in Phase 2</p>
            </div>
        </div>
    </div>

    <div id="password-generator-modal" class="modal">
        <div class="modal-content">
            <div class="modal-header">
                <h3 class="modal-title">🔒 Password Generator</h3>
                <button class="close-btn">&times;</button>
            </div>
            <div class="coming-soon-content">
                <div class="coming-soon-icon">🚧</div>
                <h3>Coming Soon!</h3>
                <p>Secure password generation tool with advanced features:</p>
                <ul>
                    <li>🔐 Customizable length and complexity</li>
                    <li>🎛️ Character set options</li>
                    <li>💪 Strength assessment</li>
                    <li>📋 Bulk generation</li>
                    <li>🚫 Exclude similar characters</li>
                </ul>
                <p><strong>Expected Release:</strong> Next 2 weeks</p>
            </div>
        </div>
    </div>

    <div id="base64-converter-modal" class="modal">
        <div class="modal-content">
            <div class="modal-header">
                <h3 class="modal-title">🔤 Base64 Encoder/Decoder</h3>
                <button class="close-btn">&times;</button>
            </div>
            <div class="coming-soon-content">
                <div class="coming-soon-icon">🚧</div>
                <h3>Coming Soon!</h3>
                <p>Professional Base64 encoding/decoding tool:</p>
                <ul>
                    <li>📝 Text and file encoding</li>
                    <li>🔄 Real-time conversion</li>
                    <li>📁 Drag & drop file support</li>
                    <li>💾 Download encoded results</li>
                    <li>✅ Format validation</li>
                </ul>
                <p><strong>Expected Release:</strong> Coming in Phase 2</p>
            </div>
        </div>
    </div>

    <div id="hash-generator-modal" class="modal">
        <div class="modal-content">
            <div class="modal-header">
                <h3 class="modal-title">🔐 Hash Generator</h3>
                <button class="close-btn">&times;</button>
            </div>
            <div class="coming-soon-content">
                <div class="coming-soon-icon">🚧</div>
                <h3>Coming Soon!</h3>
                <p>Multi-algorithm hash generation tool:</p>
                <ul>
                    <li>🔐 MD5, SHA1, SHA256, SHA512</li>
                    <li>📄 Text and file hashing</li>
                    <li>⚡ Real-time generation</li>
                    <li>🔍 Hash verification</li>
                    <li>📋 Copy and export options</li>
                </ul>
                <p><strong>Expected Release:</strong> Coming in Phase 2</p>
            </div>
        </div>
    </div>

    <div id="json-formatter-modal" class="modal">
        <div class="modal-content">
            <div class="modal-header">
                <h3 class="modal-title">📋 JSON Formatter</h3>
                <button class="close-btn">&times;</button>
            </div>
            <div class="coming-soon-content">
                <div class="coming-soon-icon">🚧</div>
                <h3>Coming Soon!</h3>
                <p>Professional JSON processing tool:</p>
                <ul>
                    <li>✨ Format and beautify JSON</li>
                    <li>🗜️ Minify for production</li>
                    <li>✅ Validation and error detection</li>
                    <li>🌳 Tree view visualization</li>
                    <li>🔍 Search and filter</li>
                </ul>
                <p><strong>Expected Release:</strong> Next 2 weeks</p>
            </div>
        </div>
    </div>

    <!-- Enhanced PDF Converter Modal -->
    <div id="pdf-converter-modal" class="modal">
        <div class="modal-content" style="max-width: 95vw; width: 1000px;">
            <div class="modal-header">
                <h3 class="modal-title">📄 Enhanced PDF Converter</h3>
                <button class="close-btn">&times;</button>
            </div>
            
            <!-- Usage Tracker -->
            <div class="usage-tracker" id="usageTracker">
                <h3 id="userTypeTitle">🆓 Anonymous User</h3>
                <p id="usageDescription">You've used <strong><span id="usedCount">0</span></strong> of <strong>5</strong> free conversions</p>
                <div class="usage-bar">
                    <div class="usage-fill" id="usageBar" style="width: 0%"></div>
                </div>
                <p id="upgradeMessage">📝 <strong>Create a free account</strong> to get 25 conversions + batch processing!</p>
            </div>

            <!-- Processing Modes -->
            <div class="processing-modes">
                <div class="mode-card active" data-mode="single">
                    <div class="mode-icon">📄</div>
                    <h3>Single File</h3>
                    <p>Convert one file at a time</p>
                    <p><strong>Available in Free Plan</strong></p>
                </div>
                <div class="mode-card" data-mode="batch">
                    <div class="mode-icon">📚</div>
                    <h3>Batch Processing</h3>
                    <p>Convert multiple files simultaneously</p>
                    <p><strong>🔒 Requires Free Account</strong></p>
                </div>
            </div>

            <!-- Format Selection -->
            <div class="format-buttons">
                <button class="format-btn active" data-format="text">📝 Text to PDF</button>
                <button class="format-btn" data-format="word">📄 Word to PDF</button>
                <button class="format-btn" data-format="image">🖼️ Image to PDF</button>
                <button class="format-btn" data-format="csv">📊 CSV to PDF</button>
            </div>

            <!-- Single File Mode -->
            <div id="single-mode">
                <div id="text-input-area">
                    <h4>Enter your text:</h4>
                    <textarea id="textInput" placeholder="Type or paste your text here..." style="width: 100%; height: 200px; padding: 15px; border: 1px solid #ddd; border-radius: 10px; resize: vertical;"></textarea>
                </div>

                <div id="file-input-area" style="display: none;">
                    <div class="file-drop-zone" id="singleFileDropZone">
                        <p>📎 Drop your file here or click to select</p>
                        <input type="file" id="singleFileInput" class="file-input">
                    </div>
                </div>

                <div style="text-align: center; margin-top: 20px;">
                    <button class="btn" id="convertSingle">🔄 Convert to PDF</button>
                </div>
            </div>

            <!-- Batch Processing Mode -->
            <div id="batch-mode" style="display: none;">
                <div class="batch-drop-zone" id="batchDropZone">
                    <div style="font-size: 3rem; color: #667eea; margin-bottom: 15px;">📚</div>
                    <h3>Drop multiple files here</h3>
                    <p>or click to browse and select multiple files</p>
                    <p><em>Supports: .txt, .docx, .doc, .csv, .png, .jpg, .jpeg, .gif, .bmp, .webp</em></p>
                    <input type="file" id="batchFileInput" class="file-input" multiple>
                </div>

                <!-- File Queue -->
                <div class="file-queue" id="fileQueue" style="display: none;"></div>

                <!-- Batch Controls -->
                <div class="batch-controls" id="batchControls" style="display: none;">
                    <button class="btn" id="startBatch">🚀 Start Batch Conversion</button>
                    <button class="btn secondary" id="pauseBatch" style="display: none;">⏸️ Pause</button>
                    <button class="btn secondary" id="clearQueue">🗑️ Clear Queue</button>
                </div>

                <!-- Batch Summary -->
                <div class="batch-summary" id="batchSummary" style="display: none;">
                    <h3>📊 Batch Processing Complete!</h3>
                    <div class="summary-stats">
                        <div class="stat-item">
                            <div class="stat-number" id="totalFiles">0</div>
                            <div class="stat-label">Total Files</div>
                        </div>
                        <div class="stat-item">
                            <div class="stat-number" id="successfulFiles">0</div>
                            <div class="stat-label">Successful</div>
                        </div>
                        <div class="stat-item">
                            <div class="stat-number" id="failedFiles">0</div>
                            <div class="stat-label">Failed</div>
                        </div>
                        <div class="stat-item">
                            <div class="stat-number" id="totalSize">0 MB</div>
                            <div class="stat-label">Total Size</div>
                        </div>
                    </div>

                    <div style="display: flex; gap: 15px; justify-content: center; margin-top: 20px; flex-wrap: wrap;">
                        <button class="btn" id="downloadAll">📦 Download All as ZIP</button>
                        <button class="btn secondary" id="downloadIndividual">📄 Download Individual Files</button>
                    </div>
                </div>
            </div>

            <div class="progress-bar" id="pdfProgress">
                <div class="progress-fill"></div>
            </div>

            <div class="file-info" id="pdfFileInfo" style="display: none;"></div>
            <div class="result-area" id="pdfResult"></div>
        </div>
    </div>

    <!-- PDF to Text Modal -->
    <div id="pdf-to-text-modal" class="modal">
        <div class="modal-content">
            <div class="modal-header">
                <h3 class="modal-title">📄→📝 PDF to Text/Word</h3>
                <button class="close-btn">&times;</button>
            </div>

            <div class="file-drop-zone" id="pdfTextDropZone">
                <p>Drag & drop your PDF here or click to select</p>
                <input type="file" id="pdfTextInput" class="file-input" accept=".pdf">
            </div>

            <div class="progress-bar" id="pdfTextProgress">
                <div class="progress-fill"></div>
            </div>

            <div class="file-info" id="pdfTextFileInfo" style="display: none;"></div>

            <div style="text-align: center; margin-top: 20px;">
                <button class="btn" id="extractText">Extract Text</button>
                <button class="btn" id="downloadAsWord" style="display: none;">Download as Word</button>
            </div>

            <div class="result-area" id="pdfTextResult"></div>
        </div>
    </div>

    <!-- Image Converter Modal -->
    <div id="image-converter-modal" class="modal">
        <div class="modal-content">
            <div class="modal-header">
                <h3 class="modal-title">🖼️ Image Converter</h3>
                <button class="close-btn">&times;</button>
            </div>

            <div class="file-drop-zone" id="imageDropZone">
                <p>Drag & drop your image here or click to select</p>
                <input type="file" id="imageInput" class="file-input" accept=".png,.jpg,.jpeg,.gif,.bmp,.webp,.tiff,.svg,.ico,.avif">
            </div>

            <div class="format-buttons" style="display: none;" id="imageFormatButtons">
                <button class="format-btn" data-format="png">PNG</button>
                <button class="format-btn" data-format="jpeg">JPEG</button>
                <button class="format-btn" data-format="webp">WebP</button>
                <button class="format-btn" data-format="bmp">BMP</button>
                <button class="format-btn" data-format="gif">GIF</button>
                <button class="format-btn" data-format="tiff">TIFF</button>
                <button class="format-btn" data-format="avif">AVIF</button>
                <button class="format-btn" data-format="ico">ICO</button>
            </div>

            <div id="imageControls" style="display: none;">
                <div style="margin: 20px 0;">
                    <label>Quality (JPEG/WebP): <span id="qualityValue">80</span>%</label>
                    <input type="range" id="qualitySlider" min="10" max="100" value="80" style="width: 100%; margin: 10px 0;">
                </div>
            </div>

            <div class="progress-bar" id="imageProgress">
                <div class="progress-fill"></div>
            </div>

            <div class="file-info" id="imageFileInfo" style="display: none;"></div>

            <div style="text-align: center; margin-top: 20px;">
                <button class="btn" id="convertImage" style="display: none;">Convert Image</button>
            </div>

            <div class="result-area" id="imageResult"></div>
        </div>
    </div>

    <!-- Calculator Modal -->
    <div id="calculator-modal" class="modal">
        <div class="modal-content">
            <div class="modal-header">
                <h3 class="modal-title">🧮 Scientific Calculator</h3>
                <button class="close-btn">&times;</button>
            </div>

            <div style="display: flex; gap: 20px;">
                <div style="flex: 1;">
                    <div id="calculator">
                        <div id="display" style="background: #333; color: white; padding: 20px; border-radius: 10px; font-size: 2rem; text-align: right; margin-bottom: 20px; min-height: 80px; display: flex; align-items: center; justify-content: flex-end;">0</div>
                        
                        <div style="display: grid; grid-template-columns: repeat(5, 1fr); gap: 10px;">
                            <button class="btn calc-btn" onclick="clearAll()">C</button>
                            <button class="btn calc-btn" onclick="clearEntry()">CE</button>
                            <button class="btn calc-btn" onclick="backspace()">⌫</button>
                            <button class="btn calc-btn" onclick="appendOperator('/')">/</button>
                            <button class="btn calc-btn" onclick="appendOperator('*')">×</button>
                            
                            <button class="btn calc-btn" onclick="appendFunction('sin(')">sin</button>
                            <button class="btn calc-btn" onclick="appendNumber('7')">7</button>
                            <button class="btn calc-btn" onclick="appendNumber('8')">8</button>
                            <button class="btn calc-btn" onclick="appendNumber('9')">9</button>
                            <button class="btn calc-btn" onclick="appendOperator('-')">-</button>
                            
                            <button class="btn calc-btn" onclick="appendFunction('cos(')">cos</button>
                            <button class="btn calc-btn" onclick="appendNumber('4')">4</button>
                            <button class="btn calc-btn" onclick="appendNumber('5')">5</button>
                            <button class="btn calc-btn" onclick="appendNumber('6')">6</button>
                            <button class="btn calc-btn" onclick="appendOperator('+')">+</button>
                            
                            <button class="btn calc-btn" onclick="appendFunction('tan(')">tan</button>
                            <button class="btn calc-btn" onclick="appendNumber('1')">1</button>
                            <button class="btn calc-btn" onclick="appendNumber('2')">2</button>
                            <button class="btn calc-btn" onclick="appendNumber('3')">3</button>
                            <button class="btn calc-btn" onclick="calculate()" rowspan="2" style="grid-row: span 2; height: 100px;">=</button>
                            
                            <button class="btn calc-btn" onclick="appendFunction('log(')">log</button>
                            <button class="btn calc-btn" onclick="appendNumber('0')" style="grid-column: span 2;">0</button>
                            <button class="btn calc-btn" onclick="appendNumber('.')">.</button>
                        </div>
                    </div>
                </div>
                
                <div style="flex: 1;">
                    <h4>History</h4>
                    <div id="calcHistory" style="background: #f8f9fa; padding: 15px; border-radius: 10px; height: 400px; overflow-y: auto;"></div>
                    <button class="btn" onclick="clearHistory()" style="margin-top: 10px;">Clear History</button>
                </div>
            </div>
        </div>
    </div>

    <!-- Text Tools Modal -->
    <div id="text-tools-modal" class="modal">
        <div class="modal-content">
            <div class="modal-header">
                <h3 class="modal-title">📝 Text Tools</h3>
                <button class="close-btn">&times;</button>
            </div>

            <div class="format-buttons">
                <button class="format-btn active" data-tool="counter">Word Counter</button>
                <button class="format-btn" data-tool="case">Case Converter</button>
                <button class="format-btn" data-tool="lorem">Lorem Generator</button>
            </div>

            <div id="text-counter" class="text-tool">
                <textarea id="textCounter" placeholder="Type or paste your text here..." style="width: 100%; height: 300px; padding: 15px; border: 1px solid #ddd; border-radius: 10px; resize: vertical;"></textarea>
                <div style="display: grid; grid-template-columns: repeat(auto-fit, minmax(150px, 1fr)); gap: 15px; margin-top: 20px;">
                    <div class="file-info">
                        <strong>Characters:</strong> <span id="charCount">0</span>
                    </div>
                    <div class="file-info">
                        <strong>Words:</strong> <span id="wordCount">0</span>
                    </div>
                    <div class="file-info">
                        <strong>Lines:</strong> <span id="lineCount">0</span>
                    </div>
                    <div class="file-info">
                        <strong>Paragraphs:</strong> <span id="paraCount">0</span>
                    </div>
                </div>
            </div>

            <div id="text-case" class="text-tool" style="display: none;">
                <textarea id="caseText" placeholder="Type or paste your text here..." style="width: 100%; height: 200px; padding: 15px; border: 1px solid #ddd; border-radius: 10px; resize: vertical;"></textarea>
                <div style="text-align: center; margin: 20px 0;">
                    <button class="btn" onclick="convertCase('upper')">UPPERCASE</button>
                    <button class="btn" onclick="convertCase('lower')">lowercase</button>
                    <button class="btn" onclick="convertCase('title')">Title Case</button>
                    <button class="btn" onclick="convertCase('sentence')">Sentence case</button>
                </div>
                <div class="result-area" id="caseResult" style="display: block;">
                    <textarea id="caseOutput" readonly style="width: 100%; height: 150px; padding: 15px; border: 1px solid #ddd; border-radius: 10px; background: #f8f9fa;"></textarea>
                </div>
            </div>

            <div id="text-lorem" class="text-tool" style="display: none;">
                <div style="margin-bottom: 20px;">
                    <label for="loremCount">Number of paragraphs:</label>
                    <input type="number" id="loremCount" value="3" min="1" max="20" style="padding: 10px; border: 1px solid #ddd; border-radius: 5px; margin-left: 10px;">
                    <button class="btn" onclick="generateLorem()" style="margin-left: 10px;">Generate</button>
                </div>
                <div class="result-area" id="loremResult" style="display: block;">
                    <textarea id="loremOutput" readonly style="width: 100%; height: 400px; padding: 15px; border: 1px solid #ddd; border-radius: 10px; background: #f8f9fa;"></textarea>
                </div>
            </div>
        </div>
    </div>

    <!-- Processing Overlay -->
    <div class="processing-overlay" id="processingOverlay">
        <div class="processing-card">
            <div class="spinner"></div>
            <h3 id="processingTitle">Processing Files...</h3>
            <p id="processingStatus">Preparing files for conversion...</p>
        </div>
    </div>

    <script>
        // Initialize PDF.js
        pdfjsLib.GlobalWorkerOptions.workerSrc = 'https://cdnjs.cloudflare.com/ajax/libs/pdf.js/3.11.174/pdf.worker.min.js';

        // Global variables
        let currentImage = null;
        let currentPdfFile = null;
        let extractedText = '';
        let currentExpression = '';
        let calculatorHistory = [];

        // Enhanced PDF Converter variables
        let currentMode = 'single';
        let currentFormat = 'text';
        let fileQueue = [];
        let processedFiles = [];
        let isProcessing = false;
        let isPaused = false;
        let usageCount = parseInt(localStorage.getItem('pdfUsageCount') || '0');

        // Search functionality
        document.getElementById('searchTools').addEventListener('input', function(e) {
            const searchTerm = e.target.value.toLowerCase();
            const toolCards = document.querySelectorAll('.tool-card');
            
            toolCards.forEach(card => {
                const title = card.querySelector('.tool-title').textContent.toLowerCase();
                const description = card.querySelector('.tool-description').textContent.toLowerCase();
                
                if (title.includes(searchTerm) || description.includes(searchTerm)) {
                    card.style.display = 'block';
                } else {
                    card.style.display = 'none';
                }
            });
        });

        // Modal functionality
        document.querySelectorAll('.tool-card').forEach(card => {
            card.addEventListener('click', () => {
                const tool = card.dataset.tool;
                const modal = document.getElementById(tool + '-modal');
                if (modal) {
                    modal.style.display = 'block';
                    if (tool === 'pdf-converter') {
                        updateUsageTrackerDisplay();
                    }
                }
            });
        });

        document.querySelectorAll('.close-btn').forEach(btn => {
            btn.addEventListener('click', (e) => {
                e.target.closest('.modal').style.display = 'none';
            });
        });

        window.addEventListener('click', (e) => {
            if (e.target.classList.contains('modal')) {
                e.target.style.display = 'none';
            }
        });

        // Enhanced PDF Converter functionality
        
        // Usage tracking
        function updateUsageTrackerDisplay() {
            const userTypeTitle = document.getElementById('userTypeTitle');
            const usageDescription = document.getElementById('usageDescription');
            const upgradeMessage = document.getElementById('upgradeMessage');
            
            if (isAccountUser()) {
                userTypeTitle.innerHTML = '🆓 Free Account User';
                usageDescription.innerHTML = `You've used <strong><span id="usedCount">${usageCount}</span></strong> of <strong>25</strong> free conversions`;
                upgradeMessage.innerHTML = '⭐ <strong>Upgrade to Premium</strong> for unlimited conversions and advanced features!';
                const percentage = (usageCount / 25) * 100;
                document.getElementById('usageBar').style.width = percentage + '%';
            } else {
                userTypeTitle.innerHTML = '🆓 Anonymous User';
                usageDescription.innerHTML = `You've used <strong><span id="usedCount">${usageCount}</span></strong> of <strong>5</strong> free conversions`;
                upgradeMessage.innerHTML = '📝 <strong>Create a free account</strong> to get 25 conversions + batch processing!';
                const percentage = (usageCount / 5) * 100;
                document.getElementById('usageBar').style.width = percentage + '%';
            }
            
            document.getElementById('usedCount').textContent = usageCount;
        }

        function incrementUsage() {
            const limit = isAccountUser() ? 25 : 5;
            if (usageCount >= limit) {
                showToast(`Usage limit reached! ${isAccountUser() ? 'Upgrade to Premium' : 'Create a free account'} to continue.`, 'error');
                return false;
            }
            usageCount++;
            localStorage.setItem('pdfUsageCount', usageCount.toString());
            updateUsageTrackerDisplay();
            return true;
        }

        function isAccountUser() {
            return localStorage.getItem('simulateAccount') === 'true';
        }

        // Mode switching
        document.querySelectorAll('.mode-card').forEach(card => {
            card.addEventListener('click', () => {
                const mode = card.dataset.mode;
                
                if (mode === 'batch' && !isAccountUser()) {
                    showToast('Batch processing requires a free account. Sign up to unlock!', 'warning');
                    return;
                }
                
                switchMode(mode);
            });
        });

        function switchMode(mode) {
            currentMode = mode;
            
            // Update active card
            document.querySelectorAll('.mode-card').forEach(c => c.classList.remove('active'));
            document.querySelector(`[data-mode="${mode}"]`).classList.add('active');
            
            // Show/hide appropriate sections
            if (mode === 'single') {
                document.getElementById('single-mode').style.display = 'block';
                document.getElementById('batch-mode').style.display = 'none';
            } else {
                document.getElementById('single-mode').style.display = 'none';
                document.getElementById('batch-mode').style.display = 'block';
            }
        }

        // Format switching for PDF converter
        document.querySelectorAll('#pdf-converter-modal .format-btn').forEach(btn => {
            btn.addEventListener('click', () => {
                currentFormat = btn.dataset.format;
                
                document.querySelectorAll('#pdf-converter-modal .format-btn').forEach(b => b.classList.remove('active'));
                btn.classList.add('active');
                
                updateInputArea();
            });
        });

        function updateInputArea() {
            if (currentMode === 'single') {
                if (currentFormat === 'text') {
                    document.getElementById('text-input-area').style.display = 'block';
                    document.getElementById('file-input-area').style.display = 'none';
                } else {
                    document.getElementById('text-input-area').style.display = 'none';
                    document.getElementById('file-input-area').style.display = 'block';
                    updateFileAccept();
                }
            }
        }

        function updateFileAccept() {
            const singleInput = document.getElementById('singleFileInput');
            const batchInput = document.getElementById('batchFileInput');
            
            let accept;
            switch (currentFormat) {
                case 'word':
                    accept = '.docx,.doc';
                    break;
                case 'image':
                    accept = '.png,.jpg,.jpeg,.gif,.bmp,.webp,.tiff';
                    break;
                case 'csv':
                    accept = '.csv,.txt';
                    break;
                default:
                    accept = '.txt,.docx,.doc,.csv,.png,.jpg,.jpeg,.gif,.bmp,.webp,.tiff';
            }
            
            if (singleInput) singleInput.accept = accept;
            if (batchInput) batchInput.accept = accept;
        }

        // File drop functionality
        function setupFileDropZone(dropZoneId, fileInputId, callback) {
            const dropZone = document.getElementById(dropZoneId);
            const fileInput = document.getElementById(fileInputId);

            if (!dropZone || !fileInput) return;

            dropZone.addEventListener('click', () => fileInput.click());
            dropZone.addEventListener('dragover', (e) => {
                e.preventDefault();
                dropZone.classList.add('dragover');
            });
            dropZone.addEventListener('dragleave', () => {
                dropZone.classList.remove('dragover');
            });
            dropZone.addEventListener('drop', (e) => {
                e.preventDefault();
                dropZone.classList.remove('dragover');
                const files = Array.from(e.dataTransfer.files);
                callback(files);
            });

            fileInput.addEventListener('change', (e) => {
                const files = Array.from(e.target.files);
                callback(files);
            });
        }

        setupFileDropZone('singleFileDropZone', 'singleFileInput', (files) => {
            if (files.length > 0) handleSingleFile(files[0]);
        });
        setupFileDropZone('batchDropZone', 'batchFileInput', handleBatchFiles);
        setupFileDropZone('pdfTextDropZone', 'pdfTextInput', (files) => {
            if (files.length > 0) handlePdfTextFile(files[0]);
        });
        setupFileDropZone('imageDropZone', 'imageInput', (files) => {
            if (files.length > 0) handleImageFile(files[0]);
        });

        function handleSingleFile(file) {
            const fileInfo = document.getElementById('pdfFileInfo');
            if (fileInfo) {
                fileInfo.innerHTML = `
                    <strong>File:</strong> ${file.name}<br>
                    <strong>Size:</strong> ${formatFileSize(file.size)}<br>
                    <strong>Type:</strong> ${file.type || 'Unknown'}
                `;
                fileInfo.style.display = 'block';
            }
            
            if (file.name.toLowerCase().endsWith('.docx') || file.name.toLowerCase().endsWith('.doc')) {
                handleWordFile(file);
            } else if (file.type.startsWith('image/')) {
                handleImageToPdf(file);
            } else {
                // Handle CSV/text files
                const reader = new FileReader();
                reader.onload = (e) => {
                    const textInput = document.getElementById('textInput');
                    if (textInput) textInput.value = e.target.result;
                };
                reader.readAsText(file);
            }
            
            showToast(`File "${file.name}" loaded successfully!`, 'success');
        }

        async function handleWordFile(file) {
            try {
                const arrayBuffer = await file.arrayBuffer();
                const result = await mammoth.extractRawText({ arrayBuffer });
                const textInput = document.getElementById('textInput');
                if (textInput) textInput.value = result.value;
                showToast('Word document loaded successfully!', 'success');
            } catch (error) {
                showToast('Error reading Word document: ' + error.message, 'error');
            }
        }

        function handleImageToPdf(file) {
            const reader = new FileReader();
            reader.onload = (e) => {
                const img = new Image();
                img.onload = () => {
                    currentImage = { data: e.target.result, width: img.width, height: img.height };
                    showToast('Image loaded successfully!', 'success');
                };
                img.src = e.target.result;
            };
            reader.readAsDataURL(file);
        }

        function handleBatchFiles(files) {
            files.forEach(file => {
                if (isValidFile(file)) {
                    addToQueue(file);
                }
            });
            updateQueueDisplay();
        }

        function isValidFile(file) {
            const validTypes = [
                'text/plain', 'text/csv',
                'application/vnd.openxmlformats-officedocument.wordprocessingml.document',
                'application/msword',
                'image/png', 'image/jpeg', 'image/gif', 'image/bmp', 'image/webp', 'image/tiff'
            ];
            
            return validTypes.includes(file.type) || file.name.toLowerCase().match(/\.(txt|csv|docx?|png|jpe?g|gif|bmp|webp|tiff?)$/);
        }

        function addToQueue(file) {
            const fileItem = {
                id: Date.now() + Math.random(),
                file: file,
                name: file.name,
                size: file.size,
                status: 'pending',
                progress: 0,
                result: null,
                error: null
            };
            
            fileQueue.push(fileItem);
        }

        function updateQueueDisplay() {
            const queueDiv = document.getElementById('fileQueue');
            const controlsDiv = document.getElementById('batchControls');
            
            if (!queueDiv || !controlsDiv) return;
            
            if (fileQueue.length === 0) {
                queueDiv.style.display = 'none';
                controlsDiv.style.display = 'none';
                return;
            }
            
            queueDiv.style.display = 'block';
            controlsDiv.style.display = 'flex';
            
            queueDiv.innerHTML = fileQueue.map(item => `
                <div class="file-item" data-id="${item.id}">
                    <div style="font-size: 2rem; width: 50px; text-align: center;">${getFileIcon(item.file)}</div>
                    <div class="file-details">
                        <div class="file-name">${item.name}</div>
                        <div class="file-meta">${formatFileSize(item.size)} • ${getFileType(item.file)}</div>
                    </div>
                    <div class="file-progress">
                        <div class="file-progress-bar" style="width: ${item.progress}%"></div>
                    </div>
                    <div class="file-status status-${item.status}">${getStatusText(item.status)}</div>
                    <div class="file-actions">
                        ${item.status === 'pending' ? `<button class="action-btn" onclick="removeFromQueue('${item.id}')" title="Remove">🗑️</button>` : ''}
                        ${item.status === 'completed' ? `<button class="action-btn" onclick="downloadFile('${item.id}')" title="Download">⬇️</button>` : ''}
                    </div>
                </div>
            `).join('');
        }

        function getFileIcon(file) {
            const type = file.type || file.name.toLowerCase();
            if (type.includes('image')) return '🖼️';
            if (type.includes('word') || type.includes('doc')) return '📄';
            if (type.includes('csv')) return '📊';
            return '📝';
        }

        function getFileType(file) {
            const ext = file.name.split('.').pop().toUpperCase();
            return ext || 'Unknown';
        }

        function getStatusText(status) {
            const statusMap = {
                'pending': 'Pending',
                'processing': 'Processing...',
                'completed': 'Completed',
                'error': 'Error'
            };
            return statusMap[status] || status;
        }

        function removeFromQueue(id) {
            fileQueue = fileQueue.filter(item => item.id !== id);
            updateQueueDisplay();
        }

        // PDF Processing
        document.getElementById('convertSingle').addEventListener('click', processSingleFile);
        
        // Setup batch processing buttons when modal opens
        setTimeout(() => {
            const startBatchBtn = document.getElementById('startBatch');
            const pauseBatchBtn = document.getElementById('pauseBatch');
            const clearQueueBtn = document.getElementById('clearQueue');
            
            if (startBatchBtn) startBatchBtn.addEventListener('click', startBatchProcessing);
            if (pauseBatchBtn) pauseBatchBtn.addEventListener('click', pauseBatchProcessing);
            if (clearQueueBtn) clearQueueBtn.addEventListener('click', clearQueue);
        }, 100);

        async function processSingleFile() {
            if (!incrementUsage()) return;
            
            showProcessingOverlay('Converting file...', 'Please wait while we process your file.');
            
            try {
                const { jsPDF } = window.jspdf;
                const doc = new jsPDF();
                
                if (currentFormat === 'text') {
                    const textInput = document.getElementById('textInput');
                    const text = textInput ? textInput.value : '';
                    if (!text.trim()) {
                        showToast('Please enter some text to convert.', 'error');
                        hideProcessingOverlay();
                        return;
                    }
                    
                    const lines = doc.splitTextToSize(text, 180);
                    doc.text(lines, 20, 20);
                    
                } else if (currentFormat === 'image' && currentImage) {
                    const canvas = document.createElement('canvas');
                    const ctx = canvas.getContext('2d');
                    const img = new Image();
                    
                    await new Promise((resolve) => {
                        img.onload = () => {
                            canvas.width = img.width;
                            canvas.height = img.height;
                            ctx.drawImage(img, 0, 0);
                            
                            const imgData = canvas.toDataURL('image/jpeg', 0.8);
                            const imgWidth = 180;
                            const imgHeight = (img.height * imgWidth) / img.width;
                            
                            doc.addImage(imgData, 'JPEG', 15, 20, imgWidth, imgHeight);
                            resolve();
                        };
                        img.src = currentImage.data;
                    });
                }
                
                doc.save('converted-document.pdf');
                hideProcessingOverlay();
                showToast('PDF created successfully!', 'success');
                
            } catch (error) {
                hideProcessingOverlay();
                showToast('Error creating PDF: ' + error.message, 'error');
            }
        }

        async function startBatchProcessing() {
            if (fileQueue.length === 0) {
                showToast('No files in queue to process.', 'warning');
                return;
            }
            
            isProcessing = true;
            isPaused = false;
            
            const startBtn = document.getElementById('startBatch');
            const pauseBtn = document.getElementById('pauseBatch');
            if (startBtn) startBtn.style.display = 'none';
            if (pauseBtn) pauseBtn.style.display = 'inline-flex';
            
            showProcessingOverlay('Starting batch conversion...', `Processing ${fileQueue.length} files`);
            
            try {
                for (let i = 0; i < fileQueue.length && !isPaused; i++) {
                    const item = fileQueue[i];
                    if (item.status === 'completed') continue;
                    
                    await processFileItem(item, i + 1, fileQueue.length);
                    
                    if (!isAccountUser()) {
                        incrementUsage();
                    }
                }
                
                if (!isPaused) {
                    completeProcessing();
                }
                
            } catch (error) {
                hideProcessingOverlay();
                showToast('Batch processing error: ' + error.message, 'error');
                resetProcessingState();
            }
        }

        async function processFileItem(item, current, total) {
            try {
                item.status = 'processing';
                updateQueueDisplay();
                
                const steps = ['Reading file...', 'Converting format...', 'Generating PDF...', 'Finalizing...'];
                
                for (let step = 0; step < steps.length; step++) {
                    if (isPaused) break;
                    
                    item.progress = ((step + 1) / steps.length) * 100;
                    updateQueueDisplay();
                    
                    updateProcessingOverlay(
                        `Processing file ${current} of ${total}`,
                        `${item.name}: ${steps[step]}`
                    );
                    
                    await new Promise(resolve => setTimeout(resolve, 800));
                }
                
                if (!isPaused) {
                    item.status = 'completed';
                    item.progress = 100;
                    item.result = await generatePDF(item.file);
                    processedFiles.push(item);
                    showToast(`✅ ${item.name} converted successfully!`, 'success');
                }
                
            } catch (error) {
                item.status = 'error';
                item.error = error.message;
                showToast(`❌ Failed to convert ${item.name}`, 'error');
            }
            
            updateQueueDisplay();
        }

        async function generatePDF(file) {
            const { jsPDF } = window.jspdf;
            const doc = new jsPDF();
            
            try {
                if (file.type.includes('text') || file.name.endsWith('.txt') || file.name.endsWith('.csv')) {
                    const text = await file.text();
                    const lines = doc.splitTextToSize(text, 180);
                    doc.text(lines, 20, 20);
                    
                } else if (file.type.includes('image')) {
                    const dataURL = await fileToDataURL(file);
                    const img = await loadImage(dataURL);
                    
                    const imgWidth = 180;
                    const imgHeight = (img.height * imgWidth) / img.width;
                    doc.addImage(dataURL, 'JPEG', 15, 20, imgWidth, imgHeight);
                    
                } else if (file.name.endsWith('.docx') || file.name.endsWith('.doc')) {
                    const arrayBuffer = await file.arrayBuffer();
                    const result = await mammoth.extractRawText({ arrayBuffer });
                    const lines = doc.splitTextToSize(result.value, 180);
                    doc.text(lines, 20, 20);
                }
                
                return doc.output('blob');
                
            } catch (error) {
                throw new Error('PDF generation failed: ' + error.message);
            }
        }

        function fileToDataURL(file) {
            return new Promise((resolve, reject) => {
                const reader = new FileReader();
                reader.onload = e => resolve(e.target.result);
                reader.onerror = reject;
                reader.readAsDataURL(file);
            });
        }

        function loadImage(dataURL) {
            return new Promise((resolve, reject) => {
                const img = new Image();
                img.onload = () => resolve(img);
                img.onerror = reject;
                img.src = dataURL;
            });
        }

        function pauseBatchProcessing() {
            isPaused = true;
            isProcessing = false;
            
            const startBtn = document.getElementById('startBatch');
            const pauseBtn = document.getElementById('pauseBatch');
            if (startBtn) {
                startBtn.style.display = 'inline-flex';
                startBtn.innerHTML = '▶️ Resume Processing';
            }
            if (pauseBtn) pauseBtn.style.display = 'none';
            
            hideProcessingOverlay();
            showToast('Batch processing paused. Click Resume to continue.', 'warning');
        }

        function clearQueue() {
            if (isProcessing) {
                showToast('Cannot clear queue while processing. Pause first.', 'warning');
                return;
            }
            
            fileQueue = [];
            processedFiles = [];
            updateQueueDisplay();
            hideBatchSummary();
            showToast('Queue cleared successfully.', 'success');
        }

        function completeProcessing() {
            isProcessing = false;
            isPaused = false;
            
            hideProcessingOverlay();
            resetProcessingState();
            showBatchSummary();
            
            const successful = processedFiles.filter(f => f.status === 'completed').length;
            showToast(`🎉 Batch complete! ${successful} files converted successfully.`, 'success');
        }

        function resetProcessingState() {
            const startBtn = document.getElementById('startBatch');
            const pauseBtn = document.getElementById('pauseBatch');
            if (startBtn) {
                startBtn.style.display = 'inline-flex';
                startBtn.innerHTML = '🚀 Start Batch Conversion';
            }
            if (pauseBtn) pauseBtn.style.display = 'none';
        }

        function showBatchSummary() {
            const summaryDiv = document.getElementById('batchSummary');
            if (!summaryDiv) return;
            
            const totalFiles = processedFiles.length;
            const successful = processedFiles.filter(f => f.status === 'completed').length;
            const failed = totalFiles - successful;
            const totalSize = processedFiles.reduce((sum, f) => sum + (f.result?.size || 0), 0);
            
            const totalFilesEl = document.getElementById('totalFiles');
            const successfulFilesEl = document.getElementById('successfulFiles');
            const failedFilesEl = document.getElementById('failedFiles');
            const totalSizeEl = document.getElementById('totalSize');
            
            if (totalFilesEl) totalFilesEl.textContent = totalFiles;
            if (successfulFilesEl) successfulFilesEl.textContent = successful;
            if (failedFilesEl) failedFilesEl.textContent = failed;
            if (totalSizeEl) totalSizeEl.textContent = formatFileSize(totalSize);
            
            summaryDiv.style.display = 'block';
        }

        function hideBatchSummary() {
            const summaryDiv = document.getElementById('batchSummary');
            if (summaryDiv) summaryDiv.style.display = 'none';
        }

        // Download functionality
        setTimeout(() => {
            const downloadAllBtn = document.getElementById('downloadAll');
            const downloadIndividualBtn = document.getElementById('downloadIndividual');
            
            if (downloadAllBtn) downloadAllBtn.addEventListener('click', downloadAllAsZip);
            if (downloadIndividualBtn) downloadIndividualBtn.addEventListener('click', downloadIndividualFiles);
        }, 100);

        async function downloadAllAsZip() {
            if (processedFiles.length === 0) {
                showToast('No files to download.', 'warning');
                return;
            }
            
            showProcessingOverlay('Creating ZIP file...', 'Packaging all converted files...');
            
            try {
                const zip = new JSZip();
                
                for (const item of processedFiles) {
                    if (item.result) {
                        const fileName = item.name.replace(/\.[^/.]+$/, '') + '.pdf';
                        zip.file(fileName, item.result);
                    }
                }
                
                const blob = await zip.generateAsync({ type: 'blob' });
                const url = URL.createObjectURL(blob);
                const a = document.createElement('a');
                a.href = url;
                a.download = `converted-files-${new Date().toISOString().split('T')[0]}.zip`;
                a.click();
                URL.revokeObjectURL(url);
                
                hideProcessingOverlay();
                showToast('ZIP file downloaded successfully!', 'success');
                
            } catch (error) {
                hideProcessingOverlay();
                showToast('Failed to create ZIP file: ' + error.message, 'error');
            }
        }

        function downloadIndividualFiles() {
            if (processedFiles.length === 0) {
                showToast('No files to download.', 'warning');
                return;
            }
            
            processedFiles.forEach(item => {
                if (item.result) {
                    downloadFile(item.id);
                }
            });
            
            showToast('Individual downloads started!', 'success');
        }

        function downloadFile(id) {
            const item = processedFiles.find(f => f.id === id) || fileQueue.find(f => f.id === id);
            if (!item || !item.result) return;
            
            const url = URL.createObjectURL(item.result);
            const a = document.createElement('a');
            a.href = url;
            a.download = item.name.replace(/\.[^/.]+$/, '') + '.pdf';
            a.click();
            URL.revokeObjectURL(url);
        }

        // PDF to Text functionality
        function handlePdfTextFile(file) {
            currentPdfFile = file;
            const fileInfo = document.getElementById('pdfTextFileInfo');
            if (fileInfo) {
                fileInfo.innerHTML = `
                    <strong>File:</strong> ${file.name}<br>
                    <strong>Size:</strong> ${formatFileSize(file.size)}
                `;
                fileInfo.style.display = 'block';
            }
        }

        document.getElementById('extractText').addEventListener('click', async () => {
            if (!currentPdfFile) {
                showToast('Please select a PDF file first.', 'error');
                return;
            }
            
            try {
                showProgress('pdfTextProgress', 20);
                
                const arrayBuffer = await currentPdfFile.arrayBuffer();
                const pdf = await pdfjsLib.getDocument({ data: arrayBuffer }).promise;
                
                let fullText = '';
                const totalPages = pdf.numPages;
                
                for (let i = 1; i <= totalPages; i++) {
                    showProgress('pdfTextProgress', (i / totalPages) * 80);
                    
                    const page = await pdf.getPage(i);
                    const textContent = await page.getTextContent();
                    
                    let pageText = '';
                    let lastY = null;
                    
                    textContent.items.forEach(item => {
                        if (lastY && Math.abs(lastY - item.transform[5]) > 5) {
                            pageText += '\n';
                        }
                        pageText += item.str + ' ';
                        lastY = item.transform[5];
                    });
                    
                    fullText += `\n--- Page ${i} ---\n${pageText}\n`;
                }
                
                extractedText = fullText;
                
                const resultDiv = document.getElementById('pdfTextResult');
                if (resultDiv) {
                    resultDiv.innerHTML = `
                        <h4>Extracted Text (${totalPages} pages, ${fullText.length} characters):</h4>
                        <textarea readonly style="width: 100%; height: 400px; padding: 15px; border: 1px solid #ddd; border-radius: 10px;">${fullText}</textarea>
                        <div style="margin-top: 10px;">
                            <button class="btn" onclick="copyToClipboard(\`${fullText.replace(/`/g, '\\`')}\`)">Copy Text</button>
                            <button class="btn" onclick="downloadAsText()">Download as TXT</button>
                        </div>
                    `;
                    resultDiv.style.display = 'block';
                }
                
                const downloadWordBtn = document.getElementById('downloadAsWord');
                if (downloadWordBtn) downloadWordBtn.style.display = 'inline-block';
                
                showProgress('pdfTextProgress', 100);
                showToast('Text extracted successfully!', 'success');
                hideProgress('pdfTextProgress');
                
            } catch (error) {
                showToast('Error extracting text: ' + error.message, 'error');
                hideProgress('pdfTextProgress');
            }
        });

        document.getElementById('downloadAsWord').addEventListener('click', () => {
            if (!extractedText) {
                showToast('No text to download. Please extract text first.', 'error');
                return;
            }
            
            const wordContent = `
                <html xmlns:o="urn:schemas-microsoft-com:office:office" xmlns:w="urn:schemas-microsoft-com:office:word" xmlns="http://www.w3.org/TR/REC-html40">
                <head>
                    <meta charset="utf-8">
                    <title>Extracted PDF Text</title>
                    <style>
                        @page { margin: 1in; }
                        body { font-family: 'Times New Roman', serif; font-size: 12pt; line-height: 1.5; }
                        h1 { font-size: 16pt; font-weight: bold; margin-bottom: 12pt; }
                        p { margin-bottom: 12pt; text-align: justify; }
                    </style>
                </head>
                <body>
                    <h1>Extracted PDF Text</h1>
                    ${extractedText.split('\n').map(line => `<p>${line}</p>`).join('')}
                </body>
                </html>
            `;
            
            const blob = new Blob([wordContent], { type: 'application/vnd.openxmlformats-officedocument.wordprocessingml.document' });
            const url = URL.createObjectURL(blob);
            const a = document.createElement('a');
            a.href = url;
            a.download = 'extracted-text.doc';
            a.click();
            URL.revokeObjectURL(url);
            
            showToast('Word document downloaded!', 'success');
        });

        // Image Converter functionality
        function handleImageFile(file) {
            currentImage = file;
            const fileInfo = document.getElementById('imageFileInfo');
            if (fileInfo) {
                fileInfo.innerHTML = `
                    <strong>File:</strong> ${file.name}<br>
                    <strong>Size:</strong> ${formatFileSize(file.size)}<br>
                    <strong>Dimensions:</strong> Loading...
                `;
                fileInfo.style.display = 'block';

                const reader = new FileReader();
                reader.onload = (e) => {
                    const img = new Image();
                    img.onload = () => {
                        fileInfo.innerHTML += `<br><strong>Dimensions:</strong> ${img.width} × ${img.height}px`;
                        
                        const preview = document.createElement('img');
                        preview.src = e.target.result;
                        preview.className = 'image-preview';
                        fileInfo.appendChild(preview);
                    };
                    img.src = e.target.result;
                };
                reader.readAsDataURL(file);
            }

            const formatButtons = document.getElementById('imageFormatButtons');
            const controls = document.getElementById('imageControls');
            const convertBtn = document.getElementById('convertImage');
            
            if (formatButtons) formatButtons.style.display = 'block';
            if (controls) controls.style.display = 'block';
            if (convertBtn) convertBtn.style.display = 'inline-block';
        }

        document.querySelectorAll('#imageFormatButtons .format-btn').forEach(btn => {
            btn.addEventListener('click', () => {
                document.querySelectorAll('#imageFormatButtons .format-btn').forEach(b => b.classList.remove('active'));
                btn.classList.add('active');
            });
        });

        const qualitySlider = document.getElementById('qualitySlider');
        const qualityValue = document.getElementById('qualityValue');
        if (qualitySlider && qualityValue) {
            qualitySlider.addEventListener('input', (e) => {
                qualityValue.textContent = e.target.value;
            });
        }

        document.getElementById('convertImage').addEventListener('click', async () => {
            const activeFormat = document.querySelector('#imageFormatButtons .format-btn.active');
            if (!activeFormat || !currentImage) {
                showToast('Please select an image and target format.', 'error');
                return;
            }
            
            const targetFormat = activeFormat.dataset.format;
            const qualitySliderEl = document.getElementById('qualitySlider');
            const quality = qualitySliderEl ? parseInt(qualitySliderEl.value) / 100 : 0.8;
            
            try {
                showProgress('imageProgress', 20);
                
                const reader = new FileReader();
                reader.onload = async (e) => {
                    const img = new Image();
                    img.onload = () => {
                        showProgress('imageProgress', 60);
                        
                        const canvas = document.createElement('canvas');
                        const ctx = canvas.getContext('2d');
                        
                        canvas.width = img.width;
                        canvas.height = img.height;
                        ctx.drawImage(img, 0, 0);
                        
                        let mimeType, extension;
                        switch (targetFormat) {
                            case 'png': mimeType = 'image/png'; extension = 'png'; break;
                            case 'jpeg': mimeType = 'image/jpeg'; extension = 'jpg'; break;
                            case 'webp': mimeType = 'image/webp'; extension = 'webp'; break;
                            case 'bmp': mimeType = 'image/bmp'; extension = 'bmp'; break;
                            case 'gif': mimeType = 'image/gif'; extension = 'gif'; break;
                            case 'tiff': mimeType = 'image/tiff'; extension = 'tiff'; break;
                            case 'avif': mimeType = 'image/avif'; extension = 'avif'; break;
                            case 'ico': mimeType = 'image/vnd.microsoft.icon'; extension = 'ico'; break;
                            default: mimeType = 'image/png'; extension = 'png';
                        }
                        
                        const dataURL = canvas.toDataURL(mimeType, quality);
                        
                        const a = document.createElement('a');
                        a.href = dataURL;
                        a.download = `converted-image.${extension}`;
                        a.click();
                        
                        const resultDiv = document.getElementById('imageResult');
                        if (resultDiv) {
                            resultDiv.innerHTML = `
                                <h4>Conversion Complete!</h4>
                                <p><strong>Format:</strong> ${targetFormat.toUpperCase()}</p>
                                <p><strong>Quality:</strong> ${Math.round(quality * 100)}%</p>
                                <img src="${dataURL}" class="image-preview" alt="Converted image">
                                <div style="margin-top: 10px;">
                                    <button class="btn" onclick="downloadImage('${dataURL}', '${extension}')">Download Again</button>
                                </div>
                            `;
                            resultDiv.style.display = 'block';
                        }
                        
                        showProgress('imageProgress', 100);
                        showToast('Image converted successfully!', 'success');
                        hideProgress('imageProgress');
                    };
                    img.src = e.target.result;
                };
                reader.readAsDataURL(currentImage);
                
            } catch (error) {
                showToast('Error converting image: ' + error.message, 'error');
                hideProgress('imageProgress');
            }
        });

        function downloadImage(dataURL, extension) {
            const a = document.createElement('a');
            a.href = dataURL;
            a.download = `converted-image.${extension}`;
            a.click();
        }

        // Calculator functionality
        function appendNumber(num) {
            if (currentExpression === '0') {
                currentExpression = num;
            } else {
                currentExpression += num;
            }
            updateDisplay();
        }

        function appendOperator(op) {
            if (currentExpression && !isNaN(currentExpression.slice(-1))) {
                currentExpression += op;
                updateDisplay();
            }
        }

        function appendFunction(func) {
            currentExpression += func;
            updateDisplay();
        }

        function updateDisplay() {
            const display = document.getElementById('display');
            if (display) display.textContent = currentExpression || '0';
        }

        function clearAll() {
            currentExpression = '';
            updateDisplay();
        }

        function clearEntry() {
            currentExpression = '';
            updateDisplay();
        }

        function backspace() {
            currentExpression = currentExpression.slice(0, -1);
            updateDisplay();
        }

        function calculate() {
            try {
                let expression = currentExpression
                    .replace(/sin/g, 'Math.sin')
                    .replace(/cos/g, 'Math.cos')
                    .replace(/tan/g, 'Math.tan')
                    .replace(/log/g, 'Math.log10')
                    .replace(/×/g, '*');
                
                const result = eval(expression);
                const calculation = {
                    expression: currentExpression,
                    result: result,
                    timestamp: new Date().toLocaleTimeString()
                };
                
                calculatorHistory.unshift(calculation);
                updateHistory();
                
                currentExpression = result.toString();
                updateDisplay();
                
            } catch (error) {
                showToast('Invalid expression', 'error');
            }
        }

        function updateHistory() {
            const historyDiv = document.getElementById('calcHistory');
            if (historyDiv) {
                historyDiv.innerHTML = calculatorHistory.map(calc => `
                    <div style="padding: 8px; margin: 5px 0; background: white; border-radius: 5px; border-left: 3px solid #667eea;">
                        <div><strong>${calc.expression} = ${calc.result}</strong></div>
                        <div style="font-size: 0.8em; color: #666;">${calc.timestamp}</div>
                    </div>
                `).join('');
            }
        }

        function clearHistory() {
            calculatorHistory = [];
            updateHistory();
        }

        // Text Tools functionality
        document.querySelectorAll('#text-tools-modal .format-btn').forEach(btn => {
            btn.addEventListener('click', () => {
                const tool = btn.dataset.tool;
                document.querySelectorAll('#text-tools-modal .format-btn').forEach(b => b.classList.remove('active'));
                btn.classList.add('active');
                
                document.querySelectorAll('.text-tool').forEach(t => t.style.display = 'none');
                const toolElement = document.getElementById('text-' + tool);
                if (toolElement) toolElement.style.display = 'block';
            });
        });

        const textCounterEl = document.getElementById('textCounter');
        if (textCounterEl) {
            textCounterEl.addEventListener('input', updateTextStats);
        }

        function updateTextStats() {
            const textCounterEl = document.getElementById('textCounter');
            if (!textCounterEl) return;
            
            const text = textCounterEl.value;
            
            const charCount = document.getElementById('charCount');
            const wordCount = document.getElementById('wordCount');
            const lineCount = document.getElementById('lineCount');
            const paraCount = document.getElementById('paraCount');
            
            if (charCount) charCount.textContent = text.length;
            if (wordCount) wordCount.textContent = text.trim() ? text.trim().split(/\s+/).length : 0;
            if (lineCount) lineCount.textContent = text.split('\n').length;
            if (paraCount) paraCount.textContent = text.trim() ? text.trim().split(/\n\s*\n/).length : 0;
        }

        const caseTextEl = document.getElementById('caseText');
        if (caseTextEl) {
            caseTextEl.addEventListener('input', () => {
                const caseOutput = document.getElementById('caseOutput');
                if (caseOutput) caseOutput.value = '';
            });
        }

        function convertCase(caseType) {
            const caseTextEl = document.getElementById('caseText');
            const caseOutputEl = document.getElementById('caseOutput');
            if (!caseTextEl || !caseOutputEl) return;
            
            const text = caseTextEl.value;
            let result = '';
            
            switch (caseType) {
                case 'upper':
                    result = text.toUpperCase();
                    break;
                case 'lower':
                    result = text.toLowerCase();
                    break;
                case 'title':
                    result = text.replace(/\w\S*/g, (txt) => 
                        txt.charAt(0).toUpperCase() + txt.substr(1).toLowerCase());
                    break;
                case 'sentence':
                    result = text.toLowerCase().replace(/(^\s*\w|[\.\!\?]\s*\w)/g, (c) => 
                        c.toUpperCase());
                    break;
            }
            
            caseOutputEl.value = result;
        }

        function generateLorem() {
            const loremCountEl = document.getElementById('loremCount');
            const loremOutputEl = document.getElementById('loremOutput');
            if (!loremCountEl || !loremOutputEl) return;
            
            const count = parseInt(loremCountEl.value) || 3;
            const loremText = "Lorem ipsum dolor sit amet, consectetur adipiscing elit, sed do eiusmod tempor incididunt ut labore et dolore magna aliqua. Ut enim ad minim veniam, quis nostrud exercitation ullamco laboris nisi ut aliquip ex ea commodo consequat. Duis aute irure dolor in reprehenderit in voluptate velit esse cillum dolore eu fugiat nulla pariatur. Excepteur sint occaecat cupidatat non proident, sunt in culpa qui officia deserunt mollit anim id est laborum.";
            
            const paragraphs = [];
            for (let i = 0; i < count; i++) {
                paragraphs.push(loremText);
            }
            
            loremOutputEl.value = paragraphs.join('\n\n');
        }

        // Utility functions
        function formatFileSize(bytes) {
            if (bytes === 0) return '0 Bytes';
            const k = 1024;
            const sizes = ['Bytes', 'KB', 'MB', 'GB'];
            const i = Math.floor(Math.log(bytes) / Math.log(k));
            return parseFloat((bytes / Math.pow(k, i)).toFixed(2)) + ' ' + sizes[i];
        }

        function showProgress(progressId, percentage) {
            const progressBar = document.getElementById(progressId);
            if (!progressBar) return;
            const progressFill = progressBar.querySelector('.progress-fill');
            progressBar.style.display = 'block';
            if (progressFill) progressFill.style.width = percentage + '%';
        }

        function hideProgress(progressId) {
            setTimeout(() => {
                const progressBar = document.getElementById(progressId);
                if (progressBar) progressBar.style.display = 'none';
            }, 1000);
        }

        function showProcessingOverlay(title, status) {
            const overlay = document.getElementById('processingOverlay');
            const titleEl = document.getElementById('processingTitle');
            const statusEl = document.getElementById('processingStatus');
            
            if (titleEl) titleEl.textContent = title;
            if (statusEl) statusEl.textContent = status;
            if (overlay) overlay.style.display = 'flex';
        }

        function hideProcessingOverlay() {
            const overlay = document.getElementById('processingOverlay');
            if (overlay) overlay.style.display = 'none';
        }

        function updateProcessingOverlay(title, status) {
            const titleEl = document.getElementById('processingTitle');
            const statusEl = document.getElementById('processingStatus');
            
            if (titleEl) titleEl.textContent = title;
            if (statusEl) statusEl.textContent = status;
        }

        function showToast(message, type = 'success') {
            // Remove existing toasts
            document.querySelectorAll('.toast').forEach(t => t.remove());
            
            const toast = document.createElement('div');
            toast.className = `toast ${type}`;
            toast.textContent = message;
            document.body.appendChild(toast);
            
            // Trigger animation
            setTimeout(() => toast.classList.add('show'), 100);
            
            // Auto remove
            setTimeout(() => {
                toast.classList.remove('show');
                setTimeout(() => toast.remove(), 300);
            }, 4000);
        }

        function copyToClipboard(text) {
            navigator.clipboard.writeText(text).then(() => {
                showToast('Copied to clipboard!', 'success');
            }).catch(() => {
                showToast('Failed to copy to clipboard', 'error');
            });
        }

        function downloadAsText() {
            if (!extractedText) return;
            const blob = new Blob([extractedText], { type: 'text/plain' });
            const url = URL.createObjectURL(blob);
            const a = document.createElement('a');
            a.href = url;
            a.download = 'extracted-text.txt';
            a.click();
            URL.revokeObjectURL(url);
        }

        // Initialize
        document.addEventListener('DOMContentLoaded', () => {
            updateUsageTrackerDisplay();
            updateInputArea();
            updateFileAccept();
            generateLorem();
            updateTextStats();
            
            // Demo buttons for testing different account states
            if (window.location.search.includes('demo=true')) {
                const demoControls = document.createElement('div');
                demoControls.innerHTML = `
                    <div style="position: fixed; top: 10px; left: 10px; background: white; padding: 15px; border-radius: 10px; box-shadow: 0 2px 10px rgba(0,0,0,0.1); z-index: 1001; font-size: 14px;">
                        <h4>Demo Controls:</h4>
                        <button onclick="localStorage.setItem('simulateAccount', 'false'); location.reload();" style="margin: 5px; padding: 8px 12px; border: none; border-radius: 5px; background: #dc3545; color: white; cursor: pointer;">Anonymous User</button>
                        <button onclick="localStorage.setItem('simulateAccount', 'true'); location.reload();" style="margin: 5px; padding: 8px 12px; border: none; border-radius: 5px; background: #007bff; color: white; cursor: pointer;">Free Account</button>
                    </div>
                `;
                document.body.appendChild(demoControls);
            }
        });
    </script>
</body>
</html>
                
