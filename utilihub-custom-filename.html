        function appendFunction(func) {
            currentExpression += func;
            updateDisplay();
        }

        function updateDisplay() {
            document.getElementById('display').textContent = currentExpression || '0';
        }

        function clearAll() {
            currentExpression = '';
            updateDisplay();
        }

        function clearEntry() {
            currentExpression = '';
            updateDisplay();
        }

        function backspace() {
            currentExpression = currentExpression.slice(0, -1);
            updateDisplay();
        }

        function calculate() {
            try {
                let expression = currentExpression
                    .replace(/sin/g, 'Math.sin')
                    .replace(/cos/g, 'Math.cos')
                    .replace(/tan/g, 'Math.tan')
                    .replace(/log/g, 'Math.log10')
                    .replace(/×/g, '*');
                
                const result = eval(expression);
                const calculation = {
                    expression: currentExpression,
                    result: result,
                    timestamp: new Date().toLocaleTimeString()
                };
                
                calculatorHistory.unshift(calculation);
                updateHistory();
                
                currentExpression = result.toString();
                updateDisplay();
                
            } catch (error) {
                showMessage('Invalid expression', 'error');
            }
        }

        function updateHistory() {
            const historyDiv = document.getElementById('calcHistory');
            historyDiv.innerHTML = calculatorHistory.map(calc => `
                <div style="padding: 8px; margin: 5px 0; background: white; border-radius: 5px; border-left: 3px solid #667eea;">
                    <div><strong>${calc.expression} = ${calc.result}</strong></div>
                    <div style="font-size: 0.8em; color: #666;">${calc.timestamp}</div>
                </div>
            `).join('');
        }

        function clearHistory() {
            calculatorHistory = [];
            updateHistory();
        }

        // Text Tools functionality
        document.querySelectorAll('#text-tools-modal .format-btn').forEach(btn => {
            btn.addEventListener('click', () => {
                const tool = btn.dataset.tool;
                document.querySelectorAll('#text-tools-modal .format-btn').forEach(b => b.classList.remove('active'));
                btn.classList.add('active');
                
                document.querySelectorAll('.text-tool').forEach(t => t.style.display = 'none');
                document.getElementById('text-' + tool).style.display = 'block';
            });
        });

        document.getElementById('textCounter').addEventListener('input', updateTextStats);

        function updateTextStats() {
            const text = document.getElementById('textCounter').value;
            
            document.getElementById('charCount').textContent = text.length;
            document.getElementById('wordCount').textContent = text.trim() ? text.trim().split(/\s+/).length : 0;
            document.getElementById('lineCount').textContent = text.split('\n').length;
            document.getElementById('paraCount').textContent = text.trim() ? text.trim().split(/\n\s*\n/).length : 0;
        }

        document.getElementById('caseText').addEventListener('input', () => {
            document.getElementById('caseOutput').value = '';
        });

        function convertCase(caseType) {
            const text = document.getElementById('caseText').value;
            let result = '';
            
            switch (caseType) {
                case 'upper':
                    result = text.toUpperCase();
                    break;
                case 'lower':
                    result = text.toLowerCase();
                    break;
                case 'title':
                    result = text.replace(/\w\S*/g, (txt) => 
                        txt.charAt(0).toUpperCase() + txt.substr(1).toLowerCase());
                    break;
                case 'sentence':
                    result = text.toLowerCase().replace(/(^\s*\w|[\.\!\?]\s*\w)/g, (c) => 
                        c.toUpperCase());
                    break;
            }
            
            document.getElementById('caseOutput').value = result;
        }

        function generateLorem() {
            const count = parseInt(document.getElementById('loremCount').value) || 3;
            const loremText = "Lorem ipsum dolor sit amet, consectetur adipiscing elit, sed do eiusmod tempor incididunt ut labore et dolore magna aliqua. Ut enim ad minim veniam, quis nostrud exercitation ullamco laboris nisi ut aliquip ex ea commodo consequat. Duis aute irure dolor in reprehenderit in voluptate velit esse cillum dolore eu fugiat nulla pariatur. Excepteur sint occaecat cupidatat non proident, sunt in culpa qui officia deserunt mollit anim id est laborum.";
            
            const paragraphs = [];
        function generateLorem() {
            const count = parseInt(document.getElementById('loremCount').value) || 3;
            const loremText = "Lorem ipsum dolor sit amet, consectetur adipiscing elit, sed do eiusmod tempor incididunt ut labore et dolore magna aliqua. Ut enim ad minim veniam, quis nostrud exercitation ullamco laboris nisi ut aliquip ex ea commodo consequat. Duis aute irure dolor in reprehenderit in voluptate velit esse cillum dolore eu fugiat nulla pariatur. Excepteur sint occaecat cupidatat non proident, sunt in culpa qui officia deserunt mollit anim id est laborum.";
            
            const paragraphs = [];
            for (let i = 0; i < count; i++) {
                paragraphs.push(loremText);
            }
            
            document.getElementById('loremOutput').value = paragraphs.join('\n\n');
        }

        // Utility functions
        function formatFileSize(bytes) {
            if (bytes === 0) return '0 Bytes';
            const k = 1024;
            const sizes = ['Bytes', 'KB', 'MB', 'GB'];
            const i = Math.floor(Math.log(bytes) / Math.log(k));
            return parseFloat((bytes / Math.pow(k, i)).toFixed(2)) + ' ' + sizes[i];
        }

        function showProgress(progressId, percentage) {
            const progressBar = document.getElementById(progressId);
            const progressFill = progressBar.querySelector('.progress-fill');
            progressBar.style.display = 'block';
            progressFill.style.width = percentage + '%';
        }

        function hideProgress(progressId) {
            setTimeout(() => {
                document.getElementById(progressId).style.display = 'none';
            }, 1000);
        }

        function showMessage(message, type) {
            const messageDiv = document.createElement('div');
            messageDiv.style.cssText = `
                position: fixed;
                top: 20px;
                right: 20px;
                padding: 15px 25px;
                border-radius: 10px;
                color: white;
                font-weight: 500;
                z-index: 10000;
                animation: slideIn 0.3s ease;
                ${type === 'error' ? 'background: #e74c3c;' : 'background: #27ae60;'}
            `;
            messageDiv.textContent = message;
            document.body.appendChild(messageDiv);
            
            setTimeout(() => {
                messageDiv.remove();
            }, 3000);
        }

        function copyToClipboard(text) {
            navigator.clipboard.writeText(text).then(() => {
                showMessage('Copied to clipboard!', 'success');
            }).catch(() => {
                showMessage('Failed to copy to clipboard', 'error');
            });
        }

        // Initialize
        document.addEventListener('DOMContentLoaded', () => {
            generateLorem();
            updateTextStats();
        });
    </script>
</body>
</html><!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>UtiliHub - Your All-in-One Utility Tools Hub</title>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/jspdf/2.5.1/jspdf.umd.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/pdf.js/3.11.174/pdf.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/mammoth/1.4.2/mammoth.browser.min.js"></script>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: 'Inter', -apple-system, BlinkMacSystemFont, sans-serif;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            min-height: 100vh;
            color: #333;
            line-height: 1.6;
        }

        .container {
            max-width: 1200px;
            margin: 0 auto;
            padding: 20px;
        }

        .header {
            text-align: center;
            margin-bottom: 40px;
            color: white;
        }

        .header h1 {
            font-size: 3rem;
            font-weight: 700;
            margin-bottom: 10px;
            text-shadow: 0 2px 4px rgba(0,0,0,0.3);
        }

        .header p {
            font-size: 1.2rem;
            opacity: 0.9;
        }

        .search-container {
            margin-bottom: 30px;
            position: relative;
        }

        .search-input {
            width: 100%;
            padding: 15px 50px 15px 20px;
            border: none;
            border-radius: 15px;
            background: rgba(255, 255, 255, 0.1);
            backdrop-filter: blur(10px);
            border: 1px solid rgba(255, 255, 255, 0.2);
            color: white;
            font-size: 1rem;
            placeholder-color: rgba(255, 255, 255, 0.7);
        }

        .search-input::placeholder {
            color: rgba(255, 255, 255, 0.7);
        }

        .tools-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(300px, 1fr));
            gap: 20px;
            margin-bottom: 40px;
        }

        .tool-card {
            background: rgba(255, 255, 255, 0.1);
            backdrop-filter: blur(10px);
            border: 1px solid rgba(255, 255, 255, 0.2);
            border-radius: 20px;
            padding: 25px;
            text-align: center;
            cursor: pointer;
            transition: all 0.3s ease;
            color: white;
        }

        .tool-card:hover {
            transform: translateY(-5px);
            background: rgba(255, 255, 255, 0.15);
            border-color: rgba(255, 255, 255, 0.3);
        }

        .tool-icon {
            font-size: 3rem;
            margin-bottom: 15px;
            display: block;
        }

        .tool-title {
            font-size: 1.3rem;
            font-weight: 600;
            margin-bottom: 10px;
        }

        .tool-description {
            opacity: 0.8;
            font-size: 0.9rem;
        }

        .tool-status {
            font-size: 0.8rem;
            margin-top: 10px;
            padding: 5px 12px;
            border-radius: 15px;
            font-weight: 600;
        }

        .tool-status.working {
            background: rgba(39, 174, 96, 0.2);
            color: #27ae60;
            border: 1px solid rgba(39, 174, 96, 0.3);
        }

        .tool-status.coming-soon {
            background: rgba(243, 156, 18, 0.2);
            color: #f39c12;
            border: 1px solid rgba(243, 156, 18, 0.3);
        }

        .tool-card.coming-soon {
            opacity: 0.8;
        }

        .tool-card.coming-soon:hover {
            transform: translateY(-2px);
            opacity: 1;
        }

        .modal {
            display: none;
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: rgba(0, 0, 0, 0.8);
            z-index: 1000;
            backdrop-filter: blur(5px);
        }

        .modal-content {
            position: absolute;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%);
            background: rgba(255, 255, 255, 0.95);
            backdrop-filter: blur(20px);
            border-radius: 20px;
            padding: 30px;
            max-width: 90vw;
            max-height: 90vh;
            overflow-y: auto;
            border: 1px solid rgba(255, 255, 255, 0.3);
        }

        .modal-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 20px;
            padding-bottom: 15px;
            border-bottom: 2px solid rgba(0, 0, 0, 0.1);
        }

        .modal-title {
            font-size: 1.5rem;
            font-weight: 600;
            color: #333;
        }

        .close-btn {
            background: none;
            border: none;
            font-size: 1.5rem;
            cursor: pointer;
            padding: 5px;
            border-radius: 50%;
            transition: background 0.3s ease;
        }

        .close-btn:hover {
            background: rgba(0, 0, 0, 0.1);
        }

        .file-drop-zone {
            border: 2px dashed #667eea;
            border-radius: 15px;
            padding: 40px 20px;
            text-align: center;
            margin: 20px 0;
            transition: all 0.3s ease;
            cursor: pointer;
        }

        .file-drop-zone:hover,
        .file-drop-zone.dragover {
            border-color: #764ba2;
            background: rgba(102, 126, 234, 0.05);
        }

        .file-input {
            display: none;
        }

        .btn {
            background: linear-gradient(135deg, #667eea, #764ba2);
            color: white;
            border: none;
            padding: 12px 25px;
            border-radius: 10px;
            cursor: pointer;
            font-size: 1rem;
            transition: all 0.3s ease;
            margin: 5px;
        }

        .btn:hover {
            transform: translateY(-2px);
            box-shadow: 0 5px 15px rgba(0, 0, 0, 0.2);
        }

        .btn:disabled {
            opacity: 0.6;
            cursor: not-allowed;
            transform: none;
        }

        .progress-bar {
            width: 100%;
            height: 8px;
            background: #e0e0e0;
            border-radius: 4px;
            overflow: hidden;
            margin: 10px 0;
            display: none;
        }

        .progress-fill {
            height: 100%;
            background: linear-gradient(90deg, #667eea, #764ba2);
            transition: width 0.3s ease;
            width: 0%;
        }

        .result-area {
            margin-top: 20px;
            padding: 20px;
            background: #f8f9fa;
            border-radius: 10px;
            display: none;
        }

        .format-buttons {
            display: flex;
            flex-wrap: wrap;
            gap: 10px;
            margin: 20px 0;
        }

        .format-btn {
            padding: 8px 16px;
            border: 2px solid #667eea;
            background: white;
            color: #667eea;
            border-radius: 8px;
            cursor: pointer;
            transition: all 0.3s ease;
        }

        .format-btn:hover,
        .format-btn.active {
            background: #667eea;
            color: white;
        }

        .image-preview {
            max-width: 300px;
            max-height: 300px;
            border-radius: 10px;
            margin: 10px 0;
        }

        .file-info {
            background: #e3f2fd;
            padding: 15px;
            border-radius: 10px;
            margin: 10px 0;
        }

        .filename-input-group {
            display: flex;
            align-items: center;
            gap: 10px;
            margin: 15px 0;
            padding: 15px;
            background: #f8f9fa;
            border-radius: 10px;
            border: 1px solid #ddd;
        }

        .filename-input {
            flex: 1;
            padding: 10px;
            border: 1px solid #ccc;
            border-radius: 5px;
            font-size: 1rem;
        }

        .filename-input:focus {
            outline: none;
            border-color: #667eea;
            box-shadow: 0 0 0 2px rgba(102, 126, 234, 0.2);
        }

        .filename-extension {
            font-weight: 600;
            color: #667eea;
            padding: 10px;
            background: white;
            border-radius: 5px;
            border: 1px solid #ccc;
        }

        .coming-soon-content {
            text-align: center;
            padding: 40px 20px;
        }

        .coming-soon-icon {
            font-size: 4rem;
            margin-bottom: 20px;
        }

        .coming-soon-content h3 {
            color: #f39c12;
            margin-bottom: 20px;
            font-size: 1.8rem;
        }

        .coming-soon-content p {
            margin-bottom: 20px;
            color: #666;
            line-height: 1.6;
        }

        .coming-soon-content ul {
            text-align: left;
            max-width: 400px;
            margin: 20px auto;
            padding: 0;
        }

        .coming-soon-content li {
            margin-bottom: 10px;
            color: #555;
            list-style: none;
            padding-left: 0;
        }

        @media (max-width: 768px) {
            .header h1 {
                font-size: 2rem;
            }
            
            .modal-content {
                margin: 10px;
                width: calc(100% - 20px);
                max-width: none;
            }
            
            .tools-grid {
                grid-template-columns: 1fr;
            }

            .filename-input-group {
                flex-direction: column;
                align-items: stretch;
            }
        }
    </style>
</head>
<body>
    <div class="container">
        <div class="header">
            <h1>🚀 UtiliHub</h1>
            <p>Your All-in-One Utility Tools Hub</p>
            <p>No downloads, no signups - just instant results</p>
        </div>

        <div class="search-container">
            <input type="text" class="search-input" id="searchTools" placeholder="Search tools...">
        </div>

        <div class="tools-grid">
            <!-- Working Tools -->
            <div class="tool-card" data-tool="pdf-converter">
                <span class="tool-icon">📄</span>
                <div class="tool-title">PDF Converter</div>
                <div class="tool-description">Convert Text, CSV, Images, Word docs to PDF</div>
                <div class="tool-status working">✅ Working</div>
            </div>

            <div class="tool-card" data-tool="pdf-to-text">
                <span class="tool-icon">📄→📝</span>
                <div class="tool-title">PDF to Text/Word</div>
                <div class="tool-description">Extract and format text from PDFs, save as Word</div>
                <div class="tool-status working">✅ Working</div>
            </div>

            <div class="tool-card" data-tool="image-converter">
                <span class="tool-icon">🖼️</span>
                <div class="tool-title">Image Converter</div>
                <div class="tool-description">Convert between PNG, JPEG, WebP, BMP, GIF, TIFF formats</div>
                <div class="tool-status working">✅ Working</div>
            </div>

            <div class="tool-card" data-tool="calculator">
                <span class="tool-icon">🧮</span>
                <div class="tool-title">Scientific Calculator</div>
                <div class="tool-description">Advanced calculations with history</div>
                <div class="tool-status working">✅ Working</div>
            </div>

            <div class="tool-card" data-tool="text-tools">
                <span class="tool-icon">📝</span>
                <div class="tool-title">Text Tools</div>
                <div class="tool-description">Word counter, case converter, Lorem generator</div>
                <div class="tool-status working">✅ Working</div>
            </div>

            <!-- Coming Soon Tools -->
            <div class="tool-card coming-soon" data-tool="url-shortener">
                <span class="tool-icon">🔗</span>
                <div class="tool-title">URL Shortener</div>
                <div class="tool-description">Create short links for long URLs</div>
                <div class="tool-status coming-soon">🚧 Coming Soon</div>
            </div>

            <div class="tool-card coming-soon" data-tool="qr-generator">
                <span class="tool-icon">📱</span>
                <div class="tool-title">QR Code Generator</div>
                <div class="tool-description">Generate QR codes for text, URLs, and more</div>
                <div class="tool-status coming-soon">🚧 Coming Soon</div>
            </div>

            <div class="tool-card coming-soon" data-tool="color-tools">
                <span class="tool-icon">🎨</span>
                <div class="tool-title">Color Tools</div>
                <div class="tool-description">Color picker, palette generator, converter</div>
                <div class="tool-status coming-soon">🚧 Coming Soon</div>
            </div>

            <div class="tool-card coming-soon" data-tool="password-generator">
                <span class="tool-icon">🔒</span>
                <div class="tool-title">Password Generator</div>
                <div class="tool-description">Generate secure passwords with custom options</div>
                <div class="tool-status coming-soon">🚧 Coming Soon</div>
            </div>

            <div class="tool-card coming-soon" data-tool="base64-converter">
                <span class="tool-icon">🔤</span>
                <div class="tool-title">Base64 Encoder/Decoder</div>
                <div class="tool-description">Encode and decode Base64 strings</div>
                <div class="tool-status coming-soon">🚧 Coming Soon</div>
            </div>

            <div class="tool-card coming-soon" data-tool="hash-generator">
                <span class="tool-icon">🔐</span>
                <div class="tool-title">Hash Generator</div>
                <div class="tool-description">Generate MD5, SHA1, SHA256 hashes</div>
                <div class="tool-status coming-soon">🚧 Coming Soon</div>
            </div>

            <div class="tool-card coming-soon" data-tool="json-formatter">
                <span class="tool-icon">📋</span>
                <div class="tool-title">JSON Formatter</div>
                <div class="tool-description">Format, validate, and minify JSON data</div>
                <div class="tool-status coming-soon">🚧 Coming Soon</div>
            </div>
        </div>
    </div>

    <!-- PDF Converter Modal -->
    <div id="pdf-converter-modal" class="modal">
        <div class="modal-content">
            <div class="modal-header">
                <h3 class="modal-title">📄 PDF Converter</h3>
                <button class="close-btn">&times;</button>
            </div>
            
            <div class="format-buttons">
                <button class="format-btn active" data-format="text">Text to PDF</button>
                <button class="format-btn" data-format="word">Word Doc to PDF</button>
                <button class="format-btn" data-format="image">Image to PDF</button>
                <button class="format-btn" data-format="csv">CSV to PDF</button>
            </div>

            <div id="text-input-area">
                <textarea id="textInput" placeholder="Enter your text here..." style="width: 100%; height: 300px; padding: 15px; border: 1px solid #ddd; border-radius: 10px; resize: vertical;"></textarea>
            </div>

            <div id="file-input-area" style="display: none;">
                <div class="file-drop-zone" id="pdfFileDropZone">
                    <p>Drag & drop your file here or click to select</p>
                    <input type="file" id="pdfFileInput" class="file-input" accept=".docx,.doc,.txt,.csv,.png,.jpg,.jpeg,.gif,.bmp,.webp,.tiff">
                </div>
            </div>

            <div class="filename-input-group" id="pdfFilenameGroup">
                <label style="min-width: 120px; font-weight: 600;">Save as:</label>
                <input type="text" class="filename-input" id="pdfFilename" placeholder="Enter filename" value="converted-document">
                <span class="filename-extension">.pdf</span>
            </div>

            <div class="progress-bar" id="pdfProgress">
                <div class="progress-fill"></div>
            </div>

            <div class="file-info" id="pdfFileInfo" style="display: none;"></div>

            <div style="text-align: center; margin-top: 20px;">
                <button class="btn" id="convertToPdf">Convert to PDF</button>
            </div>

            <div class="result-area" id="pdfResult"></div>
        </div>
    </div>

    <!-- PDF to Text Modal -->
    <div id="pdf-to-text-modal" class="modal">
        <div class="modal-content">
            <div class="modal-header">
                <h3 class="modal-title">📄→📝 PDF to Text/Word</h3>
                <button class="close-btn">&times;</button>
            </div>

            <div class="file-drop-zone" id="pdfTextDropZone">
                <p>Drag & drop your PDF here or click to select</p>
                <input type="file" id="pdfTextInput" class="file-input" accept=".pdf">
            </div>

            <div class="filename-input-group" id="extractFilenameGroup" style="display: none;">
                <label style="min-width: 120px; font-weight: 600;">Save as:</label>
                <input type="text" class="filename-input" id="extractFilename" placeholder="Enter filename" value="extracted-text">
                <span class="filename-extension" id="extractExtension">.txt</span>
            </div>

            <div class="progress-bar" id="pdfTextProgress">
                <div class="progress-fill"></div>
            </div>

            <div class="file-info" id="pdfTextFileInfo" style="display: none;"></div>

            <div style="text-align: center; margin-top: 20px;">
                <button class="btn" id="extractText">Extract Text</button>
                <button class="btn" id="downloadAsWord" style="display: none;">Download as Word</button>
                <button class="btn" id="downloadAsText" style="display: none;">Download as TXT</button>
            </div>

            <div class="result-area" id="pdfTextResult"></div>
        </div>
    </div>

    <!-- Image Converter Modal -->
    <div id="image-converter-modal" class="modal">
        <div class="modal-content">
            <div class="modal-header">
                <h3 class="modal-title">🖼️ Image Converter</h3>
                <button class="close-btn">&times;</button>
            </div>

            <div class="file-drop-zone" id="imageDropZone">
                <p>Drag & drop your image here or click to select</p>
                <input type="file" id="imageInput" class="file-input" accept=".png,.jpg,.jpeg,.gif,.bmp,.webp,.tiff,.svg,.ico,.avif">
            </div>

            <div class="format-buttons" style="display: none;" id="imageFormatButtons">
                <button class="format-btn" data-format="png">PNG</button>
                <button class="format-btn" data-format="jpeg">JPEG</button>
                <button class="format-btn" data-format="webp">WebP</button>
                <button class="format-btn" data-format="bmp">BMP</button>
                <button class="format-btn" data-format="gif">GIF</button>
                <button class="format-btn" data-format="tiff">TIFF</button>
                <button class="format-btn" data-format="avif">AVIF</button>
                <button class="format-btn" data-format="ico">ICO</button>
            </div>

            <div class="filename-input-group" id="imageFilenameGroup" style="display: none;">
                <label style="min-width: 120px; font-weight: 600;">Save as:</label>
                <input type="text" class="filename-input" id="imageFilename" placeholder="Enter filename" value="converted-image">
                <span class="filename-extension" id="imageExtension">.png</span>
            </div>

            <div id="imageControls" style="display: none;">
                <div style="margin: 20px 0;">
                    <label>Quality (JPEG/WebP): <span id="qualityValue">80</span>%</label>
                    <input type="range" id="qualitySlider" min="10" max="100" value="80" style="width: 100%; margin: 10px 0;">
                </div>
            </div>

            <div class="progress-bar" id="imageProgress">
                <div class="progress-fill"></div>
            </div>

            <div class="file-info" id="imageFileInfo" style="display: none;"></div>

            <div style="text-align: center; margin-top: 20px;">
                <button class="btn" id="convertImage" style="display: none;">Convert Image</button>
            </div>

            <div class="result-area" id="imageResult"></div>
        </div>
    </div>

    <!-- Calculator Modal -->
    <div id="calculator-modal" class="modal">
        <div class="modal-content">
            <div class="modal-header">
                <h3 class="modal-title">🧮 Scientific Calculator</h3>
                <button class="close-btn">&times;</button>
            </div>

            <div style="display: flex; gap: 20px;">
                <div style="flex: 1;">
                    <div id="calculator">
                        <div id="display" style="background: #333; color: white; padding: 20px; border-radius: 10px; font-size: 2rem; text-align: right; margin-bottom: 20px; min-height: 80px; display: flex; align-items: center; justify-content: flex-end;">0</div>
                        
                        <div style="display: grid; grid-template-columns: repeat(5, 1fr); gap: 10px;">
                            <button class="btn calc-btn" onclick="clearAll()">C</button>
                            <button class="btn calc-btn" onclick="clearEntry()">CE</button>
                            <button class="btn calc-btn" onclick="backspace()">⌫</button>
                            <button class="btn calc-btn" onclick="appendOperator('/')">/</button>
                            <button class="btn calc-btn" onclick="appendOperator('*')">×</button>
                            
                            <button class="btn calc-btn" onclick="appendFunction('sin(')">sin</button>
                            <button class="btn calc-btn" onclick="appendNumber('7')">7</button>
                            <button class="btn calc-btn" onclick="appendNumber('8')">8</button>
                            <button class="btn calc-btn" onclick="appendNumber('9')">9</button>
                            <button class="btn calc-btn" onclick="appendOperator('-')">-</button>
                            
                            <button class="btn calc-btn" onclick="appendFunction('cos(')">cos</button>
                            <button class="btn calc-btn" onclick="appendNumber('4')">4</button>
                            <button class="btn calc-btn" onclick="appendNumber('5')">5</button>
                            <button class="btn calc-btn" onclick="appendNumber('6')">6</button>
                            <button class="btn calc-btn" onclick="appendOperator('+')">+</button>
                            
                            <button class="btn calc-btn" onclick="appendFunction('tan(')">tan</button>
                            <button class="btn calc-btn" onclick="appendNumber('1')">1</button>
                            <button class="btn calc-btn" onclick="appendNumber('2')">2</button>
                            <button class="btn calc-btn" onclick="appendNumber('3')">3</button>
                            <button class="btn calc-btn" onclick="calculate()" rowspan="2" style="grid-row: span 2; height: 100px;">=</button>
                            
                            <button class="btn calc-btn" onclick="appendFunction('log(')">log</button>
                            <button class="btn calc-btn" onclick="appendNumber('0')" style="grid-column: span 2;">0</button>
                            <button class="btn calc-btn" onclick="appendNumber('.')">.</button>
                        </div>
                    </div>
                </div>
                
                <div style="flex: 1;">
                    <h4>History</h4>
                    <div id="calcHistory" style="background: #f8f9fa; padding: 15px; border-radius: 10px; height: 400px; overflow-y: auto;"></div>
                    <button class="btn" onclick="clearHistory()" style="margin-top: 10px;">Clear History</button>
                </div>
            </div>
        </div>
    </div>

    <!-- Text Tools Modal -->
    <div id="text-tools-modal" class="modal">
        <div class="modal-content">
            <div class="modal-header">
                <h3 class="modal-title">📝 Text Tools</h3>
                <button class="close-btn">&times;</button>
            </div>

            <div class="format-buttons">
                <button class="format-btn active" data-tool="counter">Word Counter</button>
                <button class="format-btn" data-tool="case">Case Converter</button>
                <button class="format-btn" data-tool="lorem">Lorem Generator</button>
            </div>

            <div id="text-counter" class="text-tool">
                <textarea id="textCounter" placeholder="Type or paste your text here..." style="width: 100%; height: 300px; padding: 15px; border: 1px solid #ddd; border-radius: 10px; resize: vertical;"></textarea>
                <div style="display: grid; grid-template-columns: repeat(auto-fit, minmax(150px, 1fr)); gap: 15px; margin-top: 20px;">
                    <div class="file-info">
                        <strong>Characters:</strong> <span id="charCount">0</span>
                    </div>
                    <div class="file-info">
                        <strong>Words:</strong> <span id="wordCount">0</span>
                    </div>
                    <div class="file-info">
                        <strong>Lines:</strong> <span id="lineCount">0</span>
                    </div>
                    <div class="file-info">
                        <strong>Paragraphs:</strong> <span id="paraCount">0</span>
                    </div>
                </div>
            </div>

            <div id="text-case" class="text-tool" style="display: none;">
                <textarea id="caseText" placeholder="Type or paste your text here..." style="width: 100%; height: 200px; padding: 15px; border: 1px solid #ddd; border-radius: 10px; resize: vertical;"></textarea>
                <div style="text-align: center; margin: 20px 0;">
                    <button class="btn" onclick="convertCase('upper')">UPPERCASE</button>
                    <button class="btn" onclick="convertCase('lower')">lowercase</button>
                    <button class="btn" onclick="convertCase('title')">Title Case</button>
                    <button class="btn" onclick="convertCase('sentence')">Sentence case</button>
                </div>
                <div class="result-area" id="caseResult" style="display: block;">
                    <textarea id="caseOutput" readonly style="width: 100%; height: 150px; padding: 15px; border: 1px solid #ddd; border-radius: 10px; background: #f8f9fa;"></textarea>
                </div>
            </div>

            <div id="text-lorem" class="text-tool" style="display: none;">
                <div style="margin-bottom: 20px;">
                    <label for="loremCount">Number of paragraphs:</label>
                    <input type="number" id="loremCount" value="3" min="1" max="20" style="padding: 10px; border: 1px solid #ddd; border-radius: 5px; margin-left: 10px;">
                    <button class="btn" onclick="generateLorem()" style="margin-left: 10px;">Generate</button>
                </div>
                <div class="result-area" id="loremResult" style="display: block;">
                    <textarea id="loremOutput" readonly style="width: 100%; height: 400px; padding: 15px; border: 1px solid #ddd; border-radius: 10px; background: #f8f9fa;"></textarea>
                </div>
            </div>
        </div>
    </div>

    <!-- Coming Soon Tools Modals -->
    <div id="url-shortener-modal" class="modal">
        <div class="modal-content">
            <div class="modal-header">
                <h3 class="modal-title">🔗 URL Shortener</h3>
                <button class="close-btn">&times;</button>
            </div>
            <div class="coming-soon-content">
                <div class="coming-soon-icon">🚧</div>
                <h3>Coming Soon!</h3>
                <p>This powerful URL shortening tool is currently under development. Soon you'll be able to:</p>
                <ul>
                    <li>✨ Create short, memorable links</li>
                    <li>📊 Track click analytics</li>
                    <li>🎯 Custom alias support</li>
                    <li>⏰ Expiration date settings</li>
                    <li>🔐 Password protection</li>
                </ul>
                <p><strong>Expected Release:</strong> Coming in Phase 2</p>
            </div>
        </div>
    </div>

    <div id="qr-generator-modal" class="modal">
        <div class="modal-content">
            <div class="modal-header">
                <h3 class="modal-title">📱 QR Code Generator</h3>
                <button class="close-btn">&times;</button>
            </div>
            <div class="coming-soon-content">
                <div class="coming-soon-icon">🚧</div>
                <h3>Coming Soon!</h3>
                <p>Advanced QR code generation is in development. Features will include:</p>
                <ul>
                    <li>🔗 URLs, text, and contact info</li>
                    <li>🎨 Customizable colors and styles</li>
                    <li>📏 Multiple size options</li>
                    <li>💾 PNG, SVG, and PDF export</li>
                    <li>🔍 Error correction levels</li>
                </ul>
                <p><strong>Expected Release:</strong> Next 2 weeks</p>
            </div>
        </div>
    </div>

    <div id="color-tools-modal" class="modal">
        <div class="modal-content">
            <div class="modal-header">
                <h3 class="modal-title">🎨 Color Tools</h3>
                <button class="close-btn">&times;</button>
            </div>
            <div class="coming-soon-content">
                <div class="coming-soon-icon">🚧</div>
                <h3>Coming Soon!</h3>
                <p>Comprehensive color tools suite in development:</p>
                <ul>
                    <li>🎯 Color picker and wheel</li>
                    <li>🔄 HEX, RGB, HSL converter</li>
                    <li>🎨 Palette generator</li>
                    <li>♿ Accessibility checker</li>
                    <li>🌈 Gradient generator</li>
                </ul>
                <p><strong>Expected Release:</strong> Coming in Phase 2</p>
            </div>
        </div>
    </div>

    <div id="password-generator-modal" class="modal">
        <div class="modal-content">
            <div class="modal-header">
                <h3 class="modal-title">🔒 Password Generator</h3>
                <button class="close-btn">&times;</button>
            </div>
            <div class="coming-soon-content">
                <div class="coming-soon-icon">🚧</div>
                <h3>Coming Soon!</h3>
                <p>Secure password generation tool with advanced features:</p>
                <ul>
                    <li>🔐 Customizable length and complexity</li>
                    <li>🎛️ Character set options</li>
                    <li>💪 Strength assessment</li>
                    <li>📋 Bulk generation</li>
                    <li>🚫 Exclude similar characters</li>
                </ul>
                <p><strong>Expected Release:</strong> Next 2 weeks</p>
            </div>
        </div>
    </div>

    <div id="base64-converter-modal" class="modal">
        <div class="modal-content">
            <div class="modal-header">
                <h3 class="modal-title">🔤 Base64 Encoder/Decoder</h3>
                <button class="close-btn">&times;</button>
            </div>
            <div class="coming-soon-content">
                <div class="coming-soon-icon">🚧</div>
                <h3>Coming Soon!</h3>
                <p>Professional Base64 encoding/decoding tool:</p>
                <ul>
                    <li>📝 Text and file encoding</li>
                    <li>🔄 Real-time conversion</li>
                    <li>📁 Drag & drop file support</li>
                    <li>💾 Download encoded results</li>
                    <li>✅ Format validation</li>
                </ul>
                <p><strong>Expected Release:</strong> Coming in Phase 2</p>
            </div>
        </div>
    </div>

    <div id="hash-generator-modal" class="modal">
        <div class="modal-content">
            <div class="modal-header">
                <h3 class="modal-title">🔐 Hash Generator</h3>
                <button class="close-btn">&times;</button>
            </div>
            <div class="coming-soon-content">
                <div class="coming-soon-icon">🚧</div>
                <h3>Coming Soon!</h3>
                <p>Multi-algorithm hash generation tool:</p>
                <ul>
                    <li>🔐 MD5, SHA1, SHA256, SHA512</li>
                    <li>📄 Text and file hashing</li>
                    <li>⚡ Real-time generation</li>
                    <li>🔍 Hash verification</li>
                    <li>📋 Copy and export options</li>
                </ul>
                <p><strong>Expected Release:</strong> Coming in Phase 2</p>
            </div>
        </div>
    </div>

    <div id="json-formatter-modal" class="modal">
        <div class="modal-content">
            <div class="modal-header">
                <h3 class="modal-title">📋 JSON Formatter</h3>
                <button class="close-btn">&times;</button>
            </div>
            <div class="coming-soon-content">
                <div class="coming-soon-icon">🚧</div>
                <h3>Coming Soon!</h3>
                <p>Professional JSON processing tool:</p>
                <ul>
                    <li>✨ Format and beautify JSON</li>
                    <li>🗜️ Minify for production</li>
                    <li>✅ Validation and error detection</li>
                    <li>🌳 Tree view visualization</li>
                    <li>🔍 Search and filter</li>
                </ul>
                <p><strong>Expected Release:</strong> Next 2 weeks</p>
            </div>
        </div>
    </div>

    <script>
        // Initialize PDF.js
        pdfjsLib.GlobalWorkerOptions.workerSrc = 'https://cdnjs.cloudflare.com/ajax/libs/pdf.js/3.11.174/pdf.worker.min.js';

        // Global variables
        let currentImage = null;
        let currentPdfFile = null;
        let extractedText = '';
        let currentExpression = '';
        let calculatorHistory = [];
        let currentConvertedImageData = null;
        let currentTargetFormat = 'png';

        // Search functionality
        document.getElementById('searchTools').addEventListener('input', function(e) {
            const searchTerm = e.target.value.toLowerCase();
            const toolCards = document.querySelectorAll('.tool-card');
            
            toolCards.forEach(card => {
                const title = card.querySelector('.tool-title').textContent.toLowerCase();
                const description = card.querySelector('.tool-description').textContent.toLowerCase();
                
                if (title.includes(searchTerm) || description.includes(searchTerm)) {
                    card.style.display = 'block';
                } else {
                    card.style.display = 'none';
                }
            });
        });

        // Modal functionality
        document.querySelectorAll('.tool-card').forEach(card => {
            card.addEventListener('click', () => {
                const tool = card.dataset.tool;
                const modal = document.getElementById(tool + '-modal');
                if (modal) {
                    modal.style.display = 'block';
                }
            });
        });

        document.querySelectorAll('.close-btn').forEach(btn => {
            btn.addEventListener('click', (e) => {
                e.target.closest('.modal').style.display = 'none';
            });
        });

        window.addEventListener('click', (e) => {
            if (e.target.classList.contains('modal')) {
                e.target.style.display = 'none';
            }
        });

        // PDF Converter functionality
        document.querySelectorAll('#pdf-converter-modal .format-btn').forEach(btn => {
            btn.addEventListener('click', () => {
                const format = btn.dataset.format;
                document.querySelectorAll('#pdf-converter-modal .format-btn').forEach(b => b.classList.remove('active'));
                btn.classList.add('active');
                
                if (format === 'text') {
                    document.getElementById('text-input-area').style.display = 'block';
                    document.getElementById('file-input-area').style.display = 'none';
                } else {
                    document.getElementById('text-input-area').style.display = 'none';
                    document.getElementById('file-input-area').style.display = 'block';
                    
                    const fileInput = document.getElementById('pdfFileInput');
                    if (format === 'word') {
                        fileInput.accept = '.docx,.doc';
                    } else if (format === 'image') {
                        fileInput.accept = '.png,.jpg,.jpeg,.gif,.bmp,.webp,.tiff';
                    } else if (format === 'csv') {
                        fileInput.accept = '.csv,.txt';
                    }
                }
            });
        });

        // File drop functionality
        function setupFileDropZone(dropZoneId, fileInputId, callback) {
            const dropZone = document.getElementById(dropZoneId);
            const fileInput = document.getElementById(fileInputId);

            dropZone.addEventListener('click', () => fileInput.click());
            dropZone.addEventListener('dragover', (e) => {
                e.preventDefault();
                dropZone.classList.add('dragover');
            });
            dropZone.addEventListener('dragleave', () => {
                dropZone.classList.remove('dragover');
            });
            dropZone.addEventListener('drop', (e) => {
                e.preventDefault();
                dropZone.classList.remove('dragover');
                const files = e.dataTransfer.files;
                if (files.length > 0) {
                    callback(files[0]);
                }
            });

            fileInput.addEventListener('change', (e) => {
                if (e.target.files.length > 0) {
                    callback(e.target.files[0]);
                }
            });
        }

        setupFileDropZone('pdfFileDropZone', 'pdfFileInput', handlePdfFile);
        setupFileDropZone('pdfTextDropZone', 'pdfTextInput', handlePdfTextFile);
        setupFileDropZone('imageDropZone', 'imageInput', handleImageFile);

        function handlePdfFile(file) {
            const fileInfo = document.getElementById('pdfFileInfo');
            fileInfo.innerHTML = `
                <strong>File:</strong> ${file.name}<br>
                <strong>Size:</strong> ${formatFileSize(file.size)}<br>
                <strong>Type:</strong> ${file.type || 'Unknown'}
            `;
            fileInfo.style.display = 'block';
            
            // Auto-populate filename from uploaded file
            const baseName = file.name.split('.').slice(0, -1).join('.');
            document.getElementById('pdfFilename').value = baseName || 'converted-document';
            
            if (file.name.toLowerCase().endsWith('.docx') || file.name.toLowerCase().endsWith('.doc')) {
                handleWordFile(file);
            } else if (file.type.startsWith('image/')) {
                handleImageToPdf(file);
            } else {
                // Handle CSV/text files
                const reader = new FileReader();
                reader.onload = (e) => {
                    document.getElementById('textInput').value = e.target.result;
                };
                reader.readAsText(file);
            }
        }

        async function handleWordFile(file) {
            try {
                const arrayBuffer = await file.arrayBuffer();
                const result = await mammoth.extractRawText({ arrayBuffer });
                document.getElementById('textInput').value = result.value;
                showMessage('Word document loaded successfully!', 'success');
            } catch (error) {
                showMessage('Error reading Word document: ' + error.message, 'error');
            }
        }

        function handleImageToPdf(file) {
            const reader = new FileReader();
            reader.onload = (e) => {
                const img = new Image();
                img.onload = () => {
                    // Store image for PDF conversion
                    currentImage = { data: e.target.result, width: img.width, height: img.height };
                    showMessage('Image loaded successfully!', 'success');
                };
                img.src = e.target.result;
            };
            reader.readAsDataURL(file);
        }

        function handlePdfTextFile(file) {
            currentPdfFile = file;
            const fileInfo = document.getElementById('pdfTextFileInfo');
            fileInfo.innerHTML = `
                <strong>File:</strong> ${file.name}<br>
                <strong>Size:</strong> ${formatFileSize(file.size)}
            `;
            fileInfo.style.display = 'block';
            
            // Auto-populate filename from uploaded file
            const baseName = file.name.split('.').slice(0, -1).join('.');
            document.getElementById('extractFilename').value = baseName + '-extracted' || 'extracted-text';
        }

        function handleImageFile(file) {
            currentImage = file;
            const fileInfo = document.getElementById('imageFileInfo');
            fileInfo.innerHTML = `
                <strong>File:</strong> ${file.name}<br>
                <strong>Size:</strong> ${formatFileSize(file.size)}<br>
                <strong>Dimensions:</strong> Loading...
            `;
            fileInfo.style.display = 'block';

            // Auto-populate filename from uploaded file
            const baseName = file.name.split('.').slice(0, -1).join('.');
            document.getElementById('imageFilename').value = baseName || 'converted-image';

            const reader = new FileReader();
            reader.onload = (e) => {
                const img = new Image();
                img.onload = () => {
                    fileInfo.innerHTML += `<br><strong>Dimensions:</strong> ${img.width} × ${img.height}px`;
                    
                    // Show preview
                    const preview = document.createElement('img');
                    preview.src = e.target.result;
                    preview.className = 'image-preview';
                    fileInfo.appendChild(preview);
                };
                img.src = e.target.result;
            };
            reader.readAsDataURL(file);

            document.getElementById('imageFormatButtons').style.display = 'block';
            document.getElementById('imageFilenameGroup').style.display = 'flex';
            document.getElementById('imageControls').style.display = 'block';
            document.getElementById('convertImage').style.display = 'inline-block';
        }

        // Custom Download Function
        function downloadFile(data, filename, mimeType = 'application/octet-stream') {
            const blob = new Blob([data], { type: mimeType });
            const url = URL.createObjectURL(blob);
            const a = document.createElement('a');
            a.href = url;
            a.download = filename;
            document.body.appendChild(a);
            a.click();
            document.body.removeChild(a);
            URL.revokeObjectURL(url);
        }

        // Custom Download for Data URLs
        function downloadDataURL(dataURL, filename) {
            const a = document.createElement('a');
            a.href = dataURL;
            a.download = filename;
            document.body.appendChild(a);
            a.click();
            document.body.removeChild(a);
        }

        // PDF Converter
        document.getElementById('convertToPdf').addEventListener('click', async () => {
            const activeFormat = document.querySelector('#pdf-converter-modal .format-btn.active').dataset.format;
            const customFilename = document.getElementById('pdfFilename').value.trim() || 'converted-document';
            
            try {
                showProgress('pdfProgress', 20);
                
                const { jsPDF } = window.jspdf;
                const doc = new jsPDF();
                
                if (activeFormat === 'text') {
                    const text = document.getElementById('textInput').value;
                    if (!text.trim()) {
                        showMessage('Please enter some text to convert.', 'error');
                        return;
                    }
                    
                    showProgress('pdfProgress', 60);
                    const lines = doc.splitTextToSize(text, 180);
                    doc.text(lines, 20, 20);
                    
                } else if (activeFormat === 'image' && currentImage) {
                    showProgress('pdfProgress', 60);
                    const canvas = document.createElement('canvas');
                    const ctx = canvas.getContext('2d');
                    const img = new Image();
                    
                    await new Promise((resolve) => {
                        img.onload = () => {
                            canvas.width = img.width;
                            canvas.height = img.height;
                            ctx.drawImage(img, 0, 0);
                            
                            const imgData = canvas.toDataURL('image/jpeg', 0.8);
                            const imgWidth = 180;
                            const imgHeight = (img.height * imgWidth) / img.width;
                            
                            doc.addImage(imgData, 'JPEG', 15, 20, imgWidth, imgHeight);
                            resolve();
                        };
                        img.src = currentImage.data || currentImage;
                    });
                    
                } else {
                    showMessage('Please select a file or enter text to convert.', 'error');
                    return;
                }
                
                showProgress('pdfProgress', 100);
                doc.save(`${customFilename}.pdf`);
                
                showMessage(`PDF saved as "${customFilename}.pdf"!`, 'success');
                hideProgress('pdfProgress');
                
            } catch (error) {
                showMessage('Error creating PDF: ' + error.message, 'error');
                hideProgress('pdfProgress');
            }
        });

        // PDF to Text Converter
        document.getElementById('extractText').addEventListener('click', async () => {
            if (!currentPdfFile) {
                showMessage('Please select a PDF file first.', 'error');
                return;
            }
            
            try {
                showProgress('pdfTextProgress', 20);
                
                const arrayBuffer = await currentPdfFile.arrayBuffer();
                const pdf = await pdfjsLib.getDocument({ data: arrayBuffer }).promise;
                
                let fullText = '';
                const totalPages = pdf.numPages;
                
                for (let i = 1; i <= totalPages; i++) {
                    showProgress('pdfTextProgress', (i / totalPages) * 80);
                    
                    const page = await pdf.getPage(i);
                    const textContent = await page.getTextContent();
                    
                    let pageText = '';
                    let lastY = null;
                    
                    textContent.items.forEach(item => {
                        if (lastY && Math.abs(lastY - item.transform[5]) > 5) {
                            pageText += '\n';
                        }
                        pageText += item.str + ' ';
                        lastY = item.transform[5];
                    });
                    
                    fullText += `\n--- Page ${i} ---\n${pageText}\n`;
                }
                
                extractedText = fullText;
                
                const resultDiv = document.getElementById('pdfTextResult');
                resultDiv.innerHTML = `
                    <h4>Extracted Text (${totalPages} pages, ${fullText.length} characters):</h4>
                    <textarea readonly style="width: 100%; height: 400px; padding: 15px; border: 1px solid #ddd; border-radius: 10px;">${fullText}</textarea>
                    <div style="margin-top: 10px;">
                        <button class="btn" onclick="copyToClipboard(\`${fullText.replace(/`/g, '\\`').replace(/\$/g, '\\)}\`)">Copy Text</button>
                    </div>
                `;
                resultDiv.style.display = 'block';
                
                document.getElementById('downloadAsWord').style.display = 'inline-block';
                document.getElementById('downloadAsText').style.display = 'inline-block';
                document.getElementById('extractFilenameGroup').style.display = 'flex';
                
                showProgress('pdfTextProgress', 100);
                showMessage('Text extracted successfully!', 'success');
                hideProgress('pdfTextProgress');
                
            } catch (error) {
                showMessage('Error extracting text: ' + error.message, 'error');
                hideProgress('pdfTextProgress');
            }
        });

        document.getElementById('downloadAsWord').addEventListener('click', () => {
            if (!extractedText) {
                showMessage('No text to download. Please extract text first.', 'error');
                return;
            }
            
            const customFilename = document.getElementById('extractFilename').value.trim() || 'extracted-text';
            
            // Create Word document content
            const wordContent = `
                <html xmlns:o="urn:schemas-microsoft-com:office:office" xmlns:w="urn:schemas-microsoft-com:office:word" xmlns="http://www.w3.org/TR/REC-html40">
                <head>
                    <meta charset="utf-8">
                    <title>Extracted PDF Text</title>
                    <!--[if gte mso 9]>
                    <xml><w:WordDocument><w:View>Print</w:View><w:Zoom>90</w:Zoom><w:DoNotPromptForConvert/><w:DoNotShowInsertionsAndDeletions/></w:WordDocument></xml>
                    <![endif]-->
                    <style>
                        @page { margin: 1in; }
                        body { font-family: 'Times New Roman', serif; font-size: 12pt; line-height: 1.5; }
                        h1 { font-size: 16pt; font-weight: bold; margin-bottom: 12pt; }
                        p { margin-bottom: 12pt; text-align: justify; }
                    </style>
                </head>
                <body>
                    <h1>Extracted PDF Text</h1>
                    ${extractedText.split('\n').map(line => `<p>${line}</p>`).join('')}
                </body>
                </html>
            `;
            
            downloadFile(wordContent, `${customFilename}.doc`, 'application/vnd.openxmlformats-officedocument.wordprocessingml.document');
            showMessage(`Word document saved as "${customFilename}.doc"!`, 'success');
        });

        document.getElementById('downloadAsText').addEventListener('click', () => {
            if (!extractedText) {
                showMessage('No text to download. Please extract text first.', 'error');
                return;
            }
            
            const customFilename = document.getElementById('extractFilename').value.trim() || 'extracted-text';
            downloadFile(extractedText, `${customFilename}.txt`, 'text/plain');
            showMessage(`Text file saved as "${customFilename}.txt"!`, 'success');
        });

        // Image Converter
        document.querySelectorAll('#imageFormatButtons .format-btn').forEach(btn => {
            btn.addEventListener('click', () => {
                document.querySelectorAll('#imageFormatButtons .format-btn').forEach(b => b.classList.remove('active'));
                btn.classList.add('active');
                currentTargetFormat = btn.dataset.format;
                
                // Update extension display
                const extension = getFileExtension(currentTargetFormat);
                document.getElementById('imageExtension').textContent = `.${extension}`;
            });
        });

        function getFileExtension(format) {
            const extensions = {
                'png': 'png',
                'jpeg': 'jpg',
                'webp': 'webp',
                'bmp': 'bmp',
                'gif': 'gif',
                'tiff': 'tiff',
                'avif': 'avif',
                'ico': 'ico'
            };
            return extensions[format] || 'png';
        }

        document.getElementById('qualitySlider').addEventListener('input', (e) => {
            document.getElementById('qualityValue').textContent = e.target.value;
        });

        document.getElementById('convertImage').addEventListener('click', async () => {
            const activeFormat = document.querySelector('#imageFormatButtons .format-btn.active');
            if (!activeFormat || !currentImage) {
                showMessage('Please select an image and target format.', 'error');
                return;
            }
            
            const targetFormat = activeFormat.dataset.format;
            const quality = parseInt(document.getElementById('qualitySlider').value) / 100;
            const customFilename = document.getElementById('imageFilename').value.trim() || 'converted-image';
            const extension = getFileExtension(targetFormat);
            
            try {
                showProgress('imageProgress', 20);
                
                const reader = new FileReader();
                reader.onload = async (e) => {
                    const img = new Image();
                    img.onload = () => {
                        showProgress('imageProgress', 60);
                        
                        const canvas = document.createElement('canvas');
                        const ctx = canvas.getContext('2d');
                        
                        canvas.width = img.width;
                        canvas.height = img.height;
                        ctx.drawImage(img, 0, 0);
                        
                        let mimeType, finalExtension;
                        switch (targetFormat) {
                            case 'png': mimeType = 'image/png'; finalExtension = 'png'; break;
                            case 'jpeg': mimeType = 'image/jpeg'; finalExtension = 'jpg'; break;
                            case 'webp': mimeType = 'image/webp'; finalExtension = 'webp'; break;
                            case 'bmp': mimeType = 'image/bmp'; finalExtension = 'bmp'; break;
                            case 'gif': mimeType = 'image/gif'; finalExtension = 'gif'; break;
                            case 'tiff': mimeType = 'image/tiff'; finalExtension = 'tiff'; break;
                            case 'avif': mimeType = 'image/avif'; finalExtension = 'avif'; break;
                            case 'ico': mimeType = 'image/vnd.microsoft.icon'; finalExtension = 'ico'; break;
                            default: mimeType = 'image/png'; finalExtension = 'png';
                        }
                        
                        const dataURL = canvas.toDataURL(mimeType, quality);
                        const finalFilename = `${customFilename}.${finalExtension}`;
                        
                        // Download with custom filename
                        downloadDataURL(dataURL, finalFilename);
                        
                        // Store for potential re-download
                        currentConvertedImageData = { dataURL, filename: finalFilename };
                        
                        // Show result
                        const resultDiv = document.getElementById('imageResult');
                        resultDiv.innerHTML = `
                            <h4>Conversion Complete!</h4>
                            <p><strong>Format:</strong> ${targetFormat.toUpperCase()}</p>
                            <p><strong>Quality:</strong> ${Math.round(quality * 100)}%</p>
                            <p><strong>Saved as:</strong> ${finalFilename}</p>
                            <img src="${dataURL}" class="image-preview" alt="Converted image">
                            <div style="margin-top: 10px;">
                                <button class="btn" onclick="downloadConvertedImageAgain()">Download Again</button>
                            </div>
                        `;
                        resultDiv.style.display = 'block';
                        
                        showProgress('imageProgress', 100);
                        showMessage(`Image saved as "${finalFilename}"!`, 'success');
                        hideProgress('imageProgress');
                    };
                    img.src = e.target.result;
                };
                reader.readAsDataURL(currentImage);
                
            } catch (error) {
                showMessage('Error converting image: ' + error.message, 'error');
                hideProgress('imageProgress');
            }
        });

        function downloadConvertedImageAgain() {
            if (currentConvertedImageData) {
                downloadDataURL(currentConvertedImageData.dataURL, currentConvertedImageData.filename);
                showMessage(`Downloaded "${currentConvertedImageData.filename}" again!`, 'success');
            }
        }

        // Calculator functionality
        function appendNumber(num) {
            if (currentExpression === '0') {
                currentExpression = num;
            } else {
                currentExpression += num;
            }
            updateDisplay();
        }

        function appendOperator(op) {
            if (currentExpression && !isNaN(currentExpression.slice(-1))) {
                currentExpression += op;
                updateDisplay();
            }
        }

        function appendFunction(func) {
            currentExpression += func;
            update